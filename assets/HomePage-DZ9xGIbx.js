const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PackageCard-b2c0ELG_.js","assets/index-BsroddAz.js","assets/index-B7rZpWz0.css","assets/ratingService-BQVaKjPx.js","assets/RatingInput-Ccf2IVGx.js","assets/Delete-DUyz88UL.js","assets/PackageMetrics-DlgATqrW.js","assets/CardContent-0rJpmwdc.js","assets/PackageList-E3yy0TpW.js"])))=>i.map(i=>d[i]);
import{g as te,a as ae,_ as J,u as we,b as R,c as W,j as o,r as y,d as oe,e as Le,s as q,f as X,h as S,i as se,B as Ce,k as G,l as Fe,m as ee,n as V,o as Q,p as pe,C as Ie,q as _,A as Se,T as A,t as ie,F as Oe,S as _e,M as U,I as Ae,G as fe,v as $e}from"./index-BsroddAz.js";import{R as Ne}from"./ratingService-BQVaKjPx.js";import{g as We}from"./getValidReactChildren-CgvfriJy.js";function Ee(e){return te("MuiPagination",e)}ae("MuiPagination",["root","ul","outlined","text"]);const De=["boundaryCount","componentName","count","defaultPage","disabled","hideNextButton","hidePrevButton","onChange","page","showFirstButton","showLastButton","siblingCount"];function Ve(e={}){const{boundaryCount:t=1,componentName:a="usePagination",count:s=1,defaultPage:c=1,disabled:d=!1,hideNextButton:f=!1,hidePrevButton:n=!1,onChange:u,page:i,showFirstButton:v=!1,showLastButton:r=!1,siblingCount:C=1}=e,h=J(e,De),[b,M]=we({controlled:i,default:c,name:a,state:"page"}),B=(p,w)=>{i||M(w),u&&u(p,w)},P=(p,w)=>{const N=w-p+1;return Array.from({length:N},(K,E)=>p+E)},j=P(1,Math.min(t,s)),z=P(Math.max(s-t+1,t+1),s),l=Math.max(Math.min(b-C,s-t-C*2-1),t+2),T=Math.min(Math.max(b+C,t+C*2+2),z.length>0?z[0]-2:s-1),L=[...v?["first"]:[],...n?[]:["previous"],...j,...l>t+2?["start-ellipsis"]:t+1<s-t?[t+1]:[],...P(l,T),...T<s-t-1?["end-ellipsis"]:s-t>t?[s-t]:[],...z,...f?[]:["next"],...r?["last"]:[]],k=p=>{switch(p){case"first":return 1;case"previous":return b-1;case"next":return b+1;case"last":return s;default:return null}},m=L.map(p=>typeof p=="number"?{onClick:w=>{B(w,p)},type:"page",page:p,selected:p===b,disabled:d,"aria-current":p===b?"true":void 0}:{onClick:w=>{B(w,k(p))},type:p,page:k(p),selected:!1,disabled:d||p.indexOf("ellipsis")===-1&&(p==="next"||p==="last"?b>=s:b<=1)});return R({items:m},h)}function qe(e){return te("MuiPaginationItem",e)}const I=ae("MuiPaginationItem",["root","page","sizeSmall","sizeLarge","text","textPrimary","textSecondary","outlined","outlinedPrimary","outlinedSecondary","rounded","ellipsis","firstLast","previousNext","focusVisible","disabled","selected","icon","colorPrimary","colorSecondary"]),he=W(o.jsx("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}),"FirstPage"),xe=W(o.jsx("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}),"LastPage"),ve=W(o.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore"),me=W(o.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext"),Ge=["className","color","component","components","disabled","page","selected","shape","size","slots","type","variant"],Pe=(e,t)=>{const{ownerState:a}=e;return[t.root,t[a.variant],t[`size${S(a.size)}`],a.variant==="text"&&t[`text${S(a.color)}`],a.variant==="outlined"&&t[`outlined${S(a.color)}`],a.shape==="rounded"&&t.rounded,a.type==="page"&&t.page,(a.type==="start-ellipsis"||a.type==="end-ellipsis")&&t.ellipsis,(a.type==="previous"||a.type==="next")&&t.previousNext,(a.type==="first"||a.type==="last")&&t.firstLast]},Ue=e=>{const{classes:t,color:a,disabled:s,selected:c,size:d,shape:f,type:n,variant:u}=e,i={root:["root",`size${S(d)}`,u,f,a!=="standard"&&`color${S(a)}`,a!=="standard"&&`${u}${S(a)}`,s&&"disabled",c&&"selected",{page:"page",first:"firstLast",last:"firstLast","start-ellipsis":"ellipsis","end-ellipsis":"ellipsis",previous:"previousNext",next:"previousNext"}[n]],icon:["icon"]};return se(i,qe,t)},He=q("div",{name:"MuiPaginationItem",slot:"Root",overridesResolver:Pe})(({theme:e,ownerState:t})=>R({},e.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,padding:"0 6px",margin:"0 3px",color:(e.vars||e).palette.text.primary,height:"auto",[`&.${I.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}},t.size==="small"&&{minWidth:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},t.size==="large"&&{minWidth:40,borderRadius:40/2,padding:"0 10px",fontSize:e.typography.pxToRem(15)})),Je=q(Ce,{name:"MuiPaginationItem",slot:"Root",overridesResolver:Pe})(({theme:e,ownerState:t})=>R({},e.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,height:32,padding:"0 6px",margin:"0 3px",color:(e.vars||e).palette.text.primary,[`&.${I.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${I.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},transition:e.transitions.create(["color","background-color"],{duration:e.transitions.duration.short}),"&:hover":{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${I.selected}`]:{backgroundColor:(e.vars||e).palette.action.selected,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:G.alpha(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(e.vars||e).palette.action.selected}},[`&.${I.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:G.alpha(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)},[`&.${I.disabled}`]:{opacity:1,color:(e.vars||e).palette.action.disabled,backgroundColor:(e.vars||e).palette.action.selected}}},t.size==="small"&&{minWidth:26,height:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},t.size==="large"&&{minWidth:40,height:40,borderRadius:40/2,padding:"0 10px",fontSize:e.typography.pxToRem(15)},t.shape==="rounded"&&{borderRadius:(e.vars||e).shape.borderRadius}),({theme:e,ownerState:t})=>R({},t.variant==="text"&&{[`&.${I.selected}`]:R({},t.color!=="standard"&&{color:(e.vars||e).palette[t.color].contrastText,backgroundColor:(e.vars||e).palette[t.color].main,"&:hover":{backgroundColor:(e.vars||e).palette[t.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[t.color].main}},[`&.${I.focusVisible}`]:{backgroundColor:(e.vars||e).palette[t.color].dark}},{[`&.${I.disabled}`]:{color:(e.vars||e).palette.action.disabled}})},t.variant==="outlined"&&{border:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${I.selected}`]:R({},t.color!=="standard"&&{color:(e.vars||e).palette[t.color].main,border:`1px solid ${e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / 0.5)`:G.alpha(e.palette[t.color].main,.5)}`,backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.activatedOpacity})`:G.alpha(e.palette[t.color].main,e.palette.action.activatedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / calc(${e.vars.palette.action.activatedOpacity} + ${e.vars.palette.action.focusOpacity}))`:G.alpha(e.palette[t.color].main,e.palette.action.activatedOpacity+e.palette.action.focusOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${I.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / calc(${e.vars.palette.action.activatedOpacity} + ${e.vars.palette.action.focusOpacity}))`:G.alpha(e.palette[t.color].main,e.palette.action.activatedOpacity+e.palette.action.focusOpacity)}},{[`&.${I.disabled}`]:{borderColor:(e.vars||e).palette.action.disabledBackground,color:(e.vars||e).palette.action.disabled}})})),Ke=q("div",{name:"MuiPaginationItem",slot:"Icon",overridesResolver:(e,t)=>t.icon})(({theme:e,ownerState:t})=>R({fontSize:e.typography.pxToRem(20),margin:"0 -8px"},t.size==="small"&&{fontSize:e.typography.pxToRem(18)},t.size==="large"&&{fontSize:e.typography.pxToRem(22)})),Qe=y.forwardRef(function(t,a){const s=oe({props:t,name:"MuiPaginationItem"}),{className:c,color:d="standard",component:f,components:n={},disabled:u=!1,page:i,selected:v=!1,shape:r="circular",size:C="medium",slots:h={},type:b="page",variant:M="text"}=s,B=J(s,Ge),P=R({},s,{color:d,disabled:u,selected:v,shape:r,size:C,type:b,variant:M}),j=Le(),z=Ue(P),T=(j?{previous:h.next||n.next||me,next:h.previous||n.previous||ve,last:h.first||n.first||he,first:h.last||n.last||xe}:{previous:h.previous||n.previous||ve,next:h.next||n.next||me,first:h.first||n.first||he,last:h.last||n.last||xe})[b];return b==="start-ellipsis"||b==="end-ellipsis"?o.jsx(He,{ref:a,ownerState:P,className:X(z.root,c),children:"…"}):o.jsxs(Je,R({ref:a,ownerState:P,component:f,disabled:u,className:X(z.root,c)},B,{children:[b==="page"&&i,T?o.jsx(Ke,{as:T,ownerState:P,className:z.icon}):null]}))}),Xe=["boundaryCount","className","color","count","defaultPage","disabled","getItemAriaLabel","hideNextButton","hidePrevButton","onChange","page","renderItem","shape","showFirstButton","showLastButton","siblingCount","size","variant"],Ye=e=>{const{classes:t,variant:a}=e;return se({root:["root",a],ul:["ul"]},Ee,t)},Ze=q("nav",{name:"MuiPagination",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,t[a.variant]]}})({}),et=q("ul",{name:"MuiPagination",slot:"Ul",overridesResolver:(e,t)=>t.ul})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"});function tt(e,t,a){return e==="page"?`${a?"":"Go to "}page ${t}`:`Go to ${e} page`}const at=y.forwardRef(function(t,a){const s=oe({props:t,name:"MuiPagination"}),{boundaryCount:c=1,className:d,color:f="standard",count:n=1,defaultPage:u=1,disabled:i=!1,getItemAriaLabel:v=tt,hideNextButton:r=!1,hidePrevButton:C=!1,renderItem:h=m=>o.jsx(Qe,R({},m)),shape:b="circular",showFirstButton:M=!1,showLastButton:B=!1,siblingCount:P=1,size:j="medium",variant:z="text"}=s,l=J(s,Xe),{items:T}=Ve(R({},s,{componentName:"Pagination"})),L=R({},s,{boundaryCount:c,color:f,count:n,defaultPage:u,disabled:i,getItemAriaLabel:v,hideNextButton:r,hidePrevButton:C,renderItem:h,shape:b,showFirstButton:M,showLastButton:B,siblingCount:P,size:j,variant:z}),k=Ye(L);return o.jsx(Ze,R({"aria-label":"pagination navigation",className:X(k.root,d),ownerState:L,ref:a},l,{children:o.jsx(et,{className:k.ul,ownerState:L,children:T.map((m,p)=>o.jsx("li",{children:h(R({},m,{color:f,"aria-label":v(m.type,m.page,m.selected),shape:b,size:j,variant:z}))},p))})}))});function ot(e){return te("MuiToggleButton",e)}const H=ae("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),ke=y.createContext({}),Be=y.createContext(void 0);function st(e,t){return t===void 0||e===void 0?!1:Array.isArray(t)?t.indexOf(e)>=0:e===t}const rt=["value"],nt=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],it=e=>{const{classes:t,fullWidth:a,selected:s,disabled:c,size:d,color:f}=e,n={root:["root",s&&"selected",c&&"disabled",a&&"fullWidth",`size${S(d)}`,f]};return se(n,ot,t)},lt=q(Ce,{name:"MuiToggleButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,t[`size${S(a.size)}`]]}})(({theme:e,ownerState:t})=>{let a=t.color==="standard"?e.palette.text.primary:e.palette[t.color].main,s;return e.vars&&(a=t.color==="standard"?e.vars.palette.text.primary:e.vars.palette[t.color].main,s=t.color==="standard"?e.vars.palette.text.primaryChannel:e.vars.palette[t.color].mainChannel),R({},e.typography.button,{borderRadius:(e.vars||e).shape.borderRadius,padding:11,border:`1px solid ${(e.vars||e).palette.divider}`,color:(e.vars||e).palette.action.active},t.fullWidth&&{width:"100%"},{[`&.${H.disabled}`]:{color:(e.vars||e).palette.action.disabled,border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:ee(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${H.selected}`]:{color:a,backgroundColor:e.vars?`rgba(${s} / ${e.vars.palette.action.selectedOpacity})`:ee(a,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${s} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:ee(a,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${s} / ${e.vars.palette.action.selectedOpacity})`:ee(a,e.palette.action.selectedOpacity)}}}},t.size==="small"&&{padding:7,fontSize:e.typography.pxToRem(13)},t.size==="large"&&{padding:15,fontSize:e.typography.pxToRem(15)})}),be=y.forwardRef(function(t,a){const s=y.useContext(ke),{value:c}=s,d=J(s,rt),f=y.useContext(Be),n=Fe(R({},d,{selected:st(t.value,c)}),t),u=oe({props:n,name:"MuiToggleButton"}),{children:i,className:v,color:r="standard",disabled:C=!1,disableFocusRipple:h=!1,fullWidth:b=!1,onChange:M,onClick:B,selected:P,size:j="medium",value:z}=u,l=J(u,nt),T=R({},u,{color:r,disabled:C,disableFocusRipple:h,fullWidth:b,size:j}),L=it(T),k=p=>{B&&(B(p,z),p.defaultPrevented)||M&&M(p,z)},m=f||"";return o.jsx(lt,R({className:X(d.className,L.root,v,m),disabled:C,focusRipple:!h,ref:a,onClick:k,onChange:M,value:z,ownerState:T,"aria-pressed":P},l,{children:i}))});function ct(e){return te("MuiToggleButtonGroup",e)}const $=ae("MuiToggleButtonGroup",["root","selected","horizontal","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth","firstButton","lastButton","middleButton"]),dt=["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"],ut=e=>{const{classes:t,orientation:a,fullWidth:s,disabled:c}=e,d={root:["root",a==="vertical"&&"vertical",s&&"fullWidth"],grouped:["grouped",`grouped${S(a)}`,c&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return se(d,ct,t)},gt=q("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[{[`& .${$.grouped}`]:t.grouped},{[`& .${$.grouped}`]:t[`grouped${S(a.orientation)}`]},{[`& .${$.firstButton}`]:t.firstButton},{[`& .${$.lastButton}`]:t.lastButton},{[`& .${$.middleButton}`]:t.middleButton},t.root,a.orientation==="vertical"&&t.vertical,a.fullWidth&&t.fullWidth]}})(({ownerState:e,theme:t})=>R({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius},e.orientation==="vertical"&&{flexDirection:"column"},e.fullWidth&&{width:"100%"},{[`& .${$.grouped}`]:R({},e.orientation==="horizontal"?{[`&.${$.selected} + .${$.grouped}.${$.selected}`]:{borderLeft:0,marginLeft:0}}:{[`&.${$.selected} + .${$.grouped}.${$.selected}`]:{borderTop:0,marginTop:0}})},e.orientation==="horizontal"?{[`& .${$.firstButton},& .${$.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${$.lastButton},& .${$.middleButton}`]:{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0}}:{[`& .${$.firstButton},& .${$.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${$.lastButton},& .${$.middleButton}`]:{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0}},e.orientation==="horizontal"?{[`& .${$.lastButton}.${H.disabled},& .${$.middleButton}.${H.disabled}`]:{borderLeft:"1px solid transparent"}}:{[`& .${$.lastButton}.${H.disabled},& .${$.middleButton}.${H.disabled}`]:{borderTop:"1px solid transparent"}})),pt=y.forwardRef(function(t,a){const s=oe({props:t,name:"MuiToggleButtonGroup"}),{children:c,className:d,color:f="standard",disabled:n=!1,exclusive:u=!1,fullWidth:i=!1,onChange:v,orientation:r="horizontal",size:C="medium",value:h}=s,b=J(s,dt),M=R({},s,{disabled:n,fullWidth:i,orientation:r,size:C}),B=ut(M),P=y.useCallback((k,m)=>{if(!v)return;const p=h&&h.indexOf(m);let w;h&&p>=0?(w=h.slice(),w.splice(p,1)):w=h?h.concat(m):[m],v(k,w)},[v,h]),j=y.useCallback((k,m)=>{v&&v(k,h===m?null:m)},[v,h]),z=y.useMemo(()=>({className:B.grouped,onChange:u?j:P,value:h,size:C,fullWidth:i,color:f,disabled:n}),[B.grouped,u,j,P,h,C,i,f,n]),l=We(c),T=l.length,L=k=>{const m=k===0,p=k===T-1;return m&&p?"":m?B.firstButton:p?B.lastButton:B.middleButton};return o.jsx(gt,R({role:"group",className:X(B.root,d),ref:a,ownerState:M},b,{children:o.jsx(ke.Provider,{value:z,children:l.map((k,m)=>o.jsx(Be.Provider,{value:L(m),children:k},m))})}))}),ft=W(o.jsx("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z"}),"ArrowDownward"),ht=W(o.jsx("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"}),"ArrowUpward"),xt=W(o.jsx("path",{d:"M3 14h4v-4H3zm0 5h4v-4H3zM3 9h4V5H3zm5 5h13v-4H8zm0 5h13v-4H8zM8 5v4h13V5z"}),"ViewList"),vt=W(o.jsx("path",{d:"M14.67 5v6.5H9.33V5zm1 6.5H21V5h-5.33zm-1 7.5v-6.5H9.33V19zm1-6.5V19H21v-6.5zm-7.34 0H3V19h5.33zm0-1V5H3v6.5z"}),"ViewModule");class ye{static async fetchFilterMetadata(){console.log("📊 Fetching filter metadata...");const t=performance.now();try{console.log("📊 Starting parallel metadata queries...");const a=this.fetchUniqueTags().then(r=>(console.log(`✅ Tags fetched: ${r.length} unique tags`),r)).catch(r=>{throw console.error("❌ Error fetching tags:",r),r}),s=this.fetchUniqueLicenses().then(r=>(console.log(`✅ Licenses fetched: ${r.length} unique licenses`),r)).catch(r=>{throw console.error("❌ Error fetching licenses:",r),r}),c=this.fetchFoldersAndCategories().then(r=>(console.log(`✅ Folders/Categories fetched: ${r.folders.length} folders`),r)).catch(r=>{throw console.error("❌ Error fetching folders/categories:",r),r}),d=this.fetchDatasetStats().then(r=>(console.log(`✅ Stats fetched: ${r.totalCount} total packages`),r)).catch(r=>{throw console.error("❌ Error fetching stats:",r),r}),[f,n,u,i]=await Promise.all([a,s,c,d]),v=((performance.now()-t)/1e3).toFixed(2);return console.log(`📊 Metadata fetch completed in ${v}s`),{allAvailableTags:f,allAvailableLicenses:n,allAvailableFolders:u.folders,allAvailableCategories:u.categories,datasetMaxStars:i.maxStars,datasetMaxCitations:i.maxCitations,totalPackageCount:i.totalCount}}catch(a){throw console.error("❌ Error fetching filter metadata:",a),a}}static async fetchPackages(t){const{searchTerm:a,selectedTags:s=[],minStars:c=null,hasGithub:d,hasWebserver:f,hasPublication:n,minCitations:u=null,minRating:i=null,folder1:v,category1:r,selectedLicenses:C=[],sortBy:h="package_name",sortDirection:b="asc",page:M=1,pageSize:B=24}=t,P=performance.now(),j=(M-1)*B,z=j+B-1;console.log(`🔎 Fetching packages (page ${M})...`);try{let l=V.from("packages").select("*",{count:"exact"});a&&(l=l.or(`package_name.ilike.%${a}%,description.ilike.%${a}%`)),s.length>0&&s.forEach(p=>{l=l.contains("tags",[p])}),c!==null&&c>0&&(l=l.gte("github_stars",c)),d&&(l=l.not("repo_link","is",null)),f&&(l=l.not("webserver","is",null)),n&&(l=l.not("publication","is",null)),u!==null&&u>0&&(l=l.gte("citations",u)),i!==null&&i>0&&(l=l.gte("average_rating",i)),v&&(l=l.eq("folder1",v)),r&&(l=l.eq("category1",r)),C.length>0&&(l=l.in("license",C)),h&&(l=l.order(h,{ascending:b==="asc",nullsFirst:!1})),l=l.range(j,z);const{data:T,error:L,count:k}=await l;if(L)throw L;const m=((performance.now()-P)/1e3).toFixed(2);return console.log(`🔎 Package fetch completed in ${m}s. Total matches: ${k}, returned: ${(T==null?void 0:T.length)||0}`),{packages:T||[],totalCount:k||0}}catch(l){throw console.error("❌ Error fetching packages:",l),l}}static async fetchUniqueTags(){console.log("  📌 Fetching unique tags...");const t=performance.now();try{const a=new Set;let s=0;const c=1e3;let d=!0,f=0;for(;d;){const{data:n,error:u}=await V.from("packages").select("tags").not("tags","is",null).range(s,s+c-1);if(u)throw console.error("  ❌ Tags query error:",u),u;if(!n||n.length===0){d=!1;break}n.forEach(i=>{i.tags&&Array.isArray(i.tags)&&i.tags.forEach(v=>{v&&v.trim()&&a.add(v.trim())})}),f+=n.length,d=n.length===c,s+=c}return console.log(`  📌 Tags query completed, processed ${f} total rows in ${((performance.now()-t)/1e3).toFixed(2)}s`),Array.from(a).sort()}catch(a){throw console.error("  ❌ Failed to fetch tags:",a),a}}static async fetchUniqueLicenses(){console.log("  📜 Fetching unique licenses...");const t=performance.now();try{const a=new Set;let s=0;const c=1e3;let d=!0,f=0;for(;d;){const{data:n,error:u}=await V.from("packages").select("license").not("license","is",null).range(s,s+c-1);if(u)throw console.error("  ❌ Licenses query error:",u),u;if(!n||n.length===0){d=!1;break}n.forEach(i=>{i.license&&i.license.trim()&&a.add(i.license.trim())}),f+=n.length,d=n.length===c,s+=c}return console.log(`  📜 Licenses query completed, processed ${f} total rows in ${((performance.now()-t)/1e3).toFixed(2)}s`),Array.from(a).sort()}catch(a){throw console.error("  ❌ Failed to fetch licenses:",a),a}}static async fetchFoldersAndCategories(){console.log("  📁 Fetching folders and categories...");const t=performance.now();try{const a={};let s=0;const c=1e3;let d=!0,f=0;for(;d;){const{data:i,error:v}=await V.from("packages").select("folder1, category1").not("folder1","is",null).range(s,s+c-1);if(v)throw console.error("  ❌ Folders/categories query error:",v),v;if(!i||i.length===0){d=!1;break}i.forEach(r=>{r.folder1&&(a[r.folder1]||(a[r.folder1]=new Set),r.category1&&a[r.folder1].add(r.category1))}),f+=i.length,d=i.length===c,s+=c}console.log(`  📁 Folders/categories query completed, processed ${f} total rows in ${((performance.now()-t)/1e3).toFixed(2)}s`);const n=Object.keys(a).sort(),u={};for(const i in a)u[i]=Array.from(a[i]).sort();return{folders:n,categories:u}}catch(a){throw console.error("  ❌ Failed to fetch folders/categories:",a),a}}static async fetchDatasetStats(){var a,s;console.log("  📊 Fetching dataset statistics...");const t=performance.now();try{console.log("    ⭐ Fetching max stars...");const{data:c,error:d}=await V.from("packages").select("github_stars").not("github_stars","is",null).order("github_stars",{ascending:!1}).limit(1);if(d)throw console.error("    ❌ Max stars query error:",d),d;console.log("    📚 Fetching max citations...");const{data:f,error:n}=await V.from("packages").select("citations").not("citations","is",null).order("citations",{ascending:!1}).limit(1);if(n)throw console.error("    ❌ Max citations query error:",n),n;console.log("    🔢 Fetching total count...");const{count:u,error:i}=await V.from("packages").select("*",{count:"exact",head:!0});if(i)throw console.error("    ❌ Count query error:",i),i;return console.log(`  📊 Stats queries completed in ${((performance.now()-t)/1e3).toFixed(2)}s`),{maxStars:((a=c==null?void 0:c[0])==null?void 0:a.github_stars)||null,maxCitations:((s=f==null?void 0:f[0])==null?void 0:s.citations)||null,totalCount:u||0}}catch(c){throw console.error("  ❌ Failed to fetch dataset stats:",c),c}}}const mt=y.lazy(()=>$e(()=>import("./PackageCard-b2c0ELG_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),bt=y.lazy(()=>$e(()=>import("./PackageList-E3yy0TpW.js"),__vite__mapDeps([8,1,2,3,4,5,6]))),Pt=()=>{const{searchTerm:e,selectedTags:t,minStars:a,hasGithub:s,hasWebserver:c,hasPublication:d,minCitations:f,minRating:n,folder1:u,category1:i,selectedLicenses:v,sortBy:r,sortDirection:C,viewMode:h,currentPage:b,totalFilteredCount:M}=Q(pe(g=>({searchTerm:g.searchTerm,selectedTags:g.selectedTags,minStars:g.minStars,hasGithub:g.hasGithub,hasWebserver:g.hasWebserver,hasPublication:g.hasPublication,minCitations:g.minCitations,minRating:g.minRating,folder1:g.folder1,category1:g.category1,selectedLicenses:g.selectedLicenses,sortBy:g.sortBy,sortDirection:g.sortDirection,viewMode:g.viewMode,currentPage:g.currentPage,totalFilteredCount:g.totalFilteredCount}))),{setSort:B,setDisplayedPackages:P,setTotalFilteredCount:j,setViewMode:z,setCurrentPage:l,setOriginalPackagesAndDeriveMetadata:T}=Q(pe(g=>({setSort:g.setSort,setDisplayedPackages:g.setDisplayedPackages,setTotalFilteredCount:g.setTotalFilteredCount,setViewMode:g.setViewMode,setCurrentPage:g.setCurrentPage,setOriginalPackagesAndDeriveMetadata:g.setOriginalPackagesAndDeriveMetadata}))),[L,k]=y.useState([]),[m,p]=y.useState(!0),[w,N]=y.useState("metadata"),[K,E]=y.useState(""),[le,Y]=y.useState({}),[ce,de]=y.useState(!1),Z=y.useRef(!1),re=y.useRef(!1),ue=24;y.useEffect(()=>{const g=Q.getState();if(g.allAvailableTags.length>0||g.allAvailableFolders.length>0){console.log("📊 Metadata already loaded, skipping fetch"),de(!0),N("packages");return}if(Z.current){console.log("📊 Metadata fetch already in progress, skipping");return}(async()=>{Z.current=!0,E(""),N("metadata"),p(!0);const D=setTimeout(()=>{E("Loading is taking longer than expected. Please refresh the page."),p(!1),N("none"),Z.current=!1},3e4);try{console.log("📊 Starting metadata fetch...");const F=await ye.fetchFilterMetadata();clearTimeout(D),Q.setState({allAvailableTags:F.allAvailableTags,allAvailableLicenses:F.allAvailableLicenses,allAvailableFolders:F.allAvailableFolders,allAvailableCategories:F.allAvailableCategories,datasetMaxStars:F.datasetMaxStars,datasetMaxCitations:F.datasetMaxCitations}),T([]),Y(O=>({...O,metadataFetch:{success:!0,totalPackages:F.totalPackageCount,timestamp:new Date().toISOString()}})),de(!0)}catch(F){clearTimeout(D),console.error("❌ Error fetching metadata:",F),E("Failed to load filter options. Please try refreshing the page."),Y(O=>({...O,metadataFetch:{success:!1,error:F.message||"Unknown error",timestamp:new Date().toISOString()}}))}finally{N("packages"),Z.current=!1}})()},[]),y.useEffect(()=>Ne.subscribe(x=>{console.log(`HomePage received rating update for package ${x.packageId}: ${x.averageRating} (${x.ratingsCount} ratings)`),k(O=>O.map(ne=>ne.id===x.packageId?{...ne,average_rating:x.averageRating,ratings_count:x.ratingsCount}:ne));const F=Q.getState().displayedPackages.map(O=>O.id===x.packageId?{...O,average_rating:x.averageRating,ratings_count:x.ratingsCount}:O);P(F)}),[P]),y.useEffect(()=>{if(!ce){console.log("⏳ Waiting for metadata to load before fetching packages");return}if(re.current){console.log("📦 Package fetch already in progress, skipping");return}(async()=>{re.current=!0,p(!0),N("packages"),E("");try{const x=await ye.fetchPackages({searchTerm:e,selectedTags:t,minStars:a,hasGithub:s,hasWebserver:c,hasPublication:d,minCitations:f,minRating:n,folder1:u,category1:i,selectedLicenses:v,sortBy:r,sortDirection:C,page:b,pageSize:ue});k(x.packages),P(x.packages),j(x.totalCount),Y(D=>({...D,packageFetch:{success:!0,totalCount:x.totalCount,displayedCount:x.packages.length,timestamp:new Date().toISOString()}}))}catch(x){const D=`Failed to fetch packages: ${(x==null?void 0:x.message)||"Unknown error"}`;E(D),console.error("❌ Error fetching packages:",x),k([]),P([]),j(0),Y(F=>({...F,packageFetch:{success:!1,error:(x==null?void 0:x.message)||"Unknown error",timestamp:new Date().toISOString()}}))}finally{p(!1),N("none"),re.current=!1}})()},[ce,b,e,t,a,s,c,d,f,n,u,i,v,r,C,P,j]),y.useEffect(()=>{console.log("🔧 HomePage Debug Info:",le)},[le]);const Re=(g,x)=>{l(x),window.scrollTo(0,0)},ze=g=>{const x=g.target.value;l(1),B(x===""?null:x,C)},Me=()=>{l(1),B(r,C==="asc"?"desc":"asc")},Te=(g,x)=>{x!==null&&z(x)},je=o.jsx(_,{display:"flex",justifyContent:"center",py:4,children:o.jsx(ie,{})}),ge=Math.ceil(M/ue);return o.jsxs(Ie,{maxWidth:"lg",sx:{pt:2,px:{xs:1,sm:2},pb:0},children:[K&&!m&&o.jsx(_,{py:4,children:o.jsxs(Se,{severity:"error",sx:{mb:2},children:[o.jsx(A,{variant:"body1",fontWeight:"medium",children:K}),o.jsx(A,{variant:"body2",sx:{mt:1},children:"Please try again or refresh the page. If the problem persists, contact support."})]})}),m&&w==="metadata"&&o.jsxs(_,{display:"flex",flexDirection:"column",alignItems:"center",py:6,gap:2,children:[o.jsx(ie,{}),o.jsx(A,{variant:"body1",color:"text.secondary",align:"center",children:"Loading filter options..."}),o.jsx(A,{variant:"body2",color:"text.secondary",align:"center",sx:{maxWidth:600},children:"Loading filter options for the best browsing experience."})]}),w!=="metadata"&&o.jsxs(_,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,flexWrap:"wrap",gap:1},children:[o.jsx(_,{sx:{display:"flex",alignItems:"center",gap:2},children:m&&w==="packages"?o.jsxs(_,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[o.jsx(ie,{size:24}),o.jsx(A,{variant:"h4",component:"h1",sx:{color:"text.secondary",fontWeight:500,letterSpacing:"-0.01em"},children:"Loading packages..."})]}):o.jsxs(A,{variant:"h4",component:"h1",sx:{mb:{xs:1,sm:0},color:"text.primary",fontWeight:500,letterSpacing:"-0.01em"},children:[M," Entries Found"]})}),o.jsxs(_,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[o.jsx(A,{variant:"body2",sx:{mr:1,minWidth:55,color:"text.secondary"},children:"Sort by:"}),o.jsx(Oe,{size:"small",variant:"outlined",sx:{minWidth:150},children:o.jsxs(_e,{id:"sort-by-select",name:"sortBy",value:r??"",displayEmpty:!0,onChange:ze,MenuProps:{PaperProps:{sx:{mt:1,borderRadius:2,minWidth:180}}},children:[o.jsx(U,{value:"package_name",children:"Name"}),o.jsx(U,{value:"average_rating",children:"Rating"}),o.jsx(U,{value:"ratings_count",children:"Number of Ratings"}),o.jsx(U,{value:"github_stars",children:"GitHub Stars"}),o.jsx(U,{value:"citations",children:"Citations"}),o.jsx(U,{value:"last_commit",children:"Last Commit"})]})}),o.jsx(Ae,{onClick:Me,size:"small","aria-label":"toggle sort direction",sx:{border:"1px solid",borderColor:"divider",ml:1,background:g=>g.palette.mode==="dark"?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.04)","&:hover":{background:g=>g.palette.action.hover}},children:C==="asc"?o.jsx(ht,{fontSize:"small"}):o.jsx(ft,{fontSize:"small"})}),o.jsxs(pt,{value:h,exclusive:!0,onChange:Te,"aria-label":"view mode",size:"small",sx:{ml:{sm:2},background:"transparent",borderRadius:2},children:[o.jsx(be,{value:"card","aria-label":"card view",sx:{borderRadius:1,px:1.5},children:o.jsx(vt,{})}),o.jsx(be,{value:"list","aria-label":"list view",sx:{borderRadius:1,px:1.5},children:o.jsx(xt,{})})]})]})]}),!m&&!K&&o.jsx(y.Suspense,{fallback:je,children:h==="card"?o.jsxs(y.Fragment,{children:[o.jsx(fe,{container:!0,spacing:2,sx:{p:0},children:L.map(g=>o.jsx(fe,{item:!0,xs:12,sm:6,md:4,lg:3,children:o.jsx(mt,{pkg:g})},g.id))}),ge>1&&o.jsx(_,{sx:{display:"flex",justifyContent:"center",mt:4,mb:2},children:o.jsx(at,{count:ge,page:b,onChange:Re,color:"primary"})})]}):o.jsx(bt,{packages:L})}),!m&&!K&&L.length===0&&M===0&&o.jsxs(_,{sx:{textAlign:"center",mt:4,py:4},children:[o.jsx(A,{variant:"h6",color:"text.secondary",children:"No packages found matching your criteria."}),o.jsx(A,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Try adjusting your filters or search terms."})]})]})};export{Pt as default};
