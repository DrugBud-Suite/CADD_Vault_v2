const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PackageCard-Dljv0P3o.js","assets/index-B9BmRKEw.js","assets/index-B7rZpWz0.css","assets/ratingService-CpAFPXpW.js","assets/RatingInput-gjInqtcc.js","assets/Delete-B7U26GE2.js","assets/PackageMetrics-gK2vdvNq.js","assets/CardContent-D6VgvhYC.js","assets/PackageList-DkuzFPk6.js"])))=>i.map(i=>d[i]);
import{r as h,g as K,a as Q,_ as S,u as Ba,b as y,c as F,j as o,d as X,e as ka,s as D,f as q,h as O,i as Y,B as fa,k as A,l as za,m as J,n as U,o as ra,C as Ra,p as w,q as na,A as ja,T as ta,F as Ma,S as _a,M as G,I as Ta,G as ia,t as la,v as va}from"./index-B9BmRKEw.js";import{R as La}from"./ratingService-CpAFPXpW.js";function Ia(a){return h.Children.toArray(a).filter(t=>h.isValidElement(t))}function Na(a){return K("MuiPagination",a)}Q("MuiPagination",["root","ul","outlined","text"]);const Oa=["boundaryCount","componentName","count","defaultPage","disabled","hideNextButton","hidePrevButton","onChange","page","showFirstButton","showLastButton","siblingCount"];function Fa(a={}){const{boundaryCount:t=1,componentName:e="usePagination",count:s=1,defaultPage:f=1,disabled:p=!1,hideNextButton:u=!1,hidePrevButton:c=!1,onChange:v,page:z,showFirstButton:m=!1,showLastButton:j=!1,siblingCount:R=1}=a,l=S(a,Oa),[g,_]=Ba({controlled:z,default:f,name:e,state:"page"}),b=(i,k)=>{z||_(k),v&&v(i,k)},B=(i,k)=>{const H=k-i+1;return Array.from({length:H},(ea,Z)=>i+Z)},I=B(1,Math.min(t,s)),P=B(Math.max(s-t+1,t+1),s),T=Math.max(Math.min(g-R,s-t-R*2-1),t+2),M=Math.min(Math.max(g+R,t+R*2+2),P.length>0?P[0]-2:s-1),L=[...m?["first"]:[],...c?[]:["previous"],...I,...T>t+2?["start-ellipsis"]:t+1<s-t?[t+1]:[],...B(T,M),...M<s-t-1?["end-ellipsis"]:s-t>t?[s-t]:[],...P,...u?[]:["next"],...j?["last"]:[]],C=i=>{switch(i){case"first":return 1;case"previous":return g-1;case"next":return g+1;case"last":return s;default:return null}},d=L.map(i=>typeof i=="number"?{onClick:k=>{b(k,i)},type:"page",page:i,selected:i===g,disabled:p,"aria-current":i===g?"true":void 0}:{onClick:k=>{b(k,C(i))},type:i,page:C(i),selected:!1,disabled:p||i.indexOf("ellipsis")===-1&&(i==="next"||i==="last"?g>=s:g<=1)});return y({items:d},l)}function Wa(a){return K("MuiPaginationItem",a)}const N=Q("MuiPaginationItem",["root","page","sizeSmall","sizeLarge","text","textPrimary","textSecondary","outlined","outlinedPrimary","outlinedSecondary","rounded","ellipsis","firstLast","previousNext","focusVisible","disabled","selected","icon","colorPrimary","colorSecondary"]),ca=F(o.jsx("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}),"FirstPage"),da=F(o.jsx("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}),"LastPage"),ua=F(o.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore"),pa=F(o.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext"),wa=["className","color","component","components","disabled","page","selected","shape","size","slots","type","variant"],xa=(a,t)=>{const{ownerState:e}=a;return[t.root,t[e.variant],t[`size${O(e.size)}`],e.variant==="text"&&t[`text${O(e.color)}`],e.variant==="outlined"&&t[`outlined${O(e.color)}`],e.shape==="rounded"&&t.rounded,e.type==="page"&&t.page,(e.type==="start-ellipsis"||e.type==="end-ellipsis")&&t.ellipsis,(e.type==="previous"||e.type==="next")&&t.previousNext,(e.type==="first"||e.type==="last")&&t.firstLast]},Da=a=>{const{classes:t,color:e,disabled:s,selected:f,size:p,shape:u,type:c,variant:v}=a,z={root:["root",`size${O(p)}`,v,u,e!=="standard"&&`color${O(e)}`,e!=="standard"&&`${v}${O(e)}`,s&&"disabled",f&&"selected",{page:"page",first:"firstLast",last:"firstLast","start-ellipsis":"ellipsis","end-ellipsis":"ellipsis",previous:"previousNext",next:"previousNext"}[c]],icon:["icon"]};return Y(z,Wa,t)},Va=D("div",{name:"MuiPaginationItem",slot:"Root",overridesResolver:xa})(({theme:a,ownerState:t})=>y({},a.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,padding:"0 6px",margin:"0 3px",color:(a.vars||a).palette.text.primary,height:"auto",[`&.${N.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity}},t.size==="small"&&{minWidth:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},t.size==="large"&&{minWidth:40,borderRadius:40/2,padding:"0 10px",fontSize:a.typography.pxToRem(15)})),Aa=D(fa,{name:"MuiPaginationItem",slot:"Root",overridesResolver:xa})(({theme:a,ownerState:t})=>y({},a.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,height:32,padding:"0 6px",margin:"0 3px",color:(a.vars||a).palette.text.primary,[`&.${N.focusVisible}`]:{backgroundColor:(a.vars||a).palette.action.focus},[`&.${N.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity},transition:a.transitions.create(["color","background-color"],{duration:a.transitions.duration.short}),"&:hover":{backgroundColor:(a.vars||a).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${N.selected}`]:{backgroundColor:(a.vars||a).palette.action.selected,"&:hover":{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.hoverOpacity}))`:A.alpha(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(a.vars||a).palette.action.selected}},[`&.${N.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:A.alpha(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)},[`&.${N.disabled}`]:{opacity:1,color:(a.vars||a).palette.action.disabled,backgroundColor:(a.vars||a).palette.action.selected}}},t.size==="small"&&{minWidth:26,height:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},t.size==="large"&&{minWidth:40,height:40,borderRadius:40/2,padding:"0 10px",fontSize:a.typography.pxToRem(15)},t.shape==="rounded"&&{borderRadius:(a.vars||a).shape.borderRadius}),({theme:a,ownerState:t})=>y({},t.variant==="text"&&{[`&.${N.selected}`]:y({},t.color!=="standard"&&{color:(a.vars||a).palette[t.color].contrastText,backgroundColor:(a.vars||a).palette[t.color].main,"&:hover":{backgroundColor:(a.vars||a).palette[t.color].dark,"@media (hover: none)":{backgroundColor:(a.vars||a).palette[t.color].main}},[`&.${N.focusVisible}`]:{backgroundColor:(a.vars||a).palette[t.color].dark}},{[`&.${N.disabled}`]:{color:(a.vars||a).palette.action.disabled}})},t.variant==="outlined"&&{border:a.vars?`1px solid rgba(${a.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${a.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${N.selected}`]:y({},t.color!=="standard"&&{color:(a.vars||a).palette[t.color].main,border:`1px solid ${a.vars?`rgba(${a.vars.palette[t.color].mainChannel} / 0.5)`:A.alpha(a.palette[t.color].main,.5)}`,backgroundColor:a.vars?`rgba(${a.vars.palette[t.color].mainChannel} / ${a.vars.palette.action.activatedOpacity})`:A.alpha(a.palette[t.color].main,a.palette.action.activatedOpacity),"&:hover":{backgroundColor:a.vars?`rgba(${a.vars.palette[t.color].mainChannel} / calc(${a.vars.palette.action.activatedOpacity} + ${a.vars.palette.action.focusOpacity}))`:A.alpha(a.palette[t.color].main,a.palette.action.activatedOpacity+a.palette.action.focusOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${N.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette[t.color].mainChannel} / calc(${a.vars.palette.action.activatedOpacity} + ${a.vars.palette.action.focusOpacity}))`:A.alpha(a.palette[t.color].main,a.palette.action.activatedOpacity+a.palette.action.focusOpacity)}},{[`&.${N.disabled}`]:{borderColor:(a.vars||a).palette.action.disabledBackground,color:(a.vars||a).palette.action.disabled}})})),Ga=D("div",{name:"MuiPaginationItem",slot:"Icon",overridesResolver:(a,t)=>t.icon})(({theme:a,ownerState:t})=>y({fontSize:a.typography.pxToRem(20),margin:"0 -8px"},t.size==="small"&&{fontSize:a.typography.pxToRem(18)},t.size==="large"&&{fontSize:a.typography.pxToRem(22)})),Ea=h.forwardRef(function(t,e){const s=X({props:t,name:"MuiPaginationItem"}),{className:f,color:p="standard",component:u,components:c={},disabled:v=!1,page:z,selected:m=!1,shape:j="circular",size:R="medium",slots:l={},type:g="page",variant:_="text"}=s,b=S(s,wa),B=y({},s,{color:p,disabled:v,selected:m,shape:j,size:R,type:g,variant:_}),I=ka(),P=Da(B),M=(I?{previous:l.next||c.next||pa,next:l.previous||c.previous||ua,last:l.first||c.first||ca,first:l.last||c.last||da}:{previous:l.previous||c.previous||ua,next:l.next||c.next||pa,first:l.first||c.first||ca,last:l.last||c.last||da})[g];return g==="start-ellipsis"||g==="end-ellipsis"?o.jsx(Va,{ref:e,ownerState:B,className:q(P.root,f),children:"â€¦"}):o.jsxs(Aa,y({ref:e,ownerState:B,component:u,disabled:v,className:q(P.root,f)},b,{children:[g==="page"&&z,M?o.jsx(Ga,{as:M,ownerState:B,className:P.icon}):null]}))}),Sa=["boundaryCount","className","color","count","defaultPage","disabled","getItemAriaLabel","hideNextButton","hidePrevButton","onChange","page","renderItem","shape","showFirstButton","showLastButton","siblingCount","size","variant"],Ha=a=>{const{classes:t,variant:e}=a;return Y({root:["root",e],ul:["ul"]},Na,t)},Ua=D("nav",{name:"MuiPagination",slot:"Root",overridesResolver:(a,t)=>{const{ownerState:e}=a;return[t.root,t[e.variant]]}})({}),qa=D("ul",{name:"MuiPagination",slot:"Ul",overridesResolver:(a,t)=>t.ul})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"});function Ja(a,t,e){return a==="page"?`${e?"":"Go to "}page ${t}`:`Go to ${a} page`}const Ka=h.forwardRef(function(t,e){const s=X({props:t,name:"MuiPagination"}),{boundaryCount:f=1,className:p,color:u="standard",count:c=1,defaultPage:v=1,disabled:z=!1,getItemAriaLabel:m=Ja,hideNextButton:j=!1,hidePrevButton:R=!1,renderItem:l=d=>o.jsx(Ea,y({},d)),shape:g="circular",showFirstButton:_=!1,showLastButton:b=!1,siblingCount:B=1,size:I="medium",variant:P="text"}=s,T=S(s,Sa),{items:M}=Fa(y({},s,{componentName:"Pagination"})),L=y({},s,{boundaryCount:f,color:u,count:c,defaultPage:v,disabled:z,getItemAriaLabel:m,hideNextButton:j,hidePrevButton:R,renderItem:l,shape:g,showFirstButton:_,showLastButton:b,siblingCount:B,size:I,variant:P}),C=Ha(L);return o.jsx(Ua,y({"aria-label":"pagination navigation",className:q(C.root,p),ownerState:L,ref:e},T,{children:o.jsx(qa,{className:C.ul,ownerState:L,children:M.map((d,i)=>o.jsx("li",{children:l(y({},d,{color:u,"aria-label":m(d.type,d.page,d.selected),shape:g,size:I,variant:P}))},i))})}))});function Qa(a){return K("MuiToggleButton",a)}const E=Q("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),ba=h.createContext({}),ha=h.createContext(void 0);function Xa(a,t){return t===void 0||a===void 0?!1:Array.isArray(t)?t.indexOf(a)>=0:a===t}const Ya=["value"],Za=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],at=a=>{const{classes:t,fullWidth:e,selected:s,disabled:f,size:p,color:u}=a,c={root:["root",s&&"selected",f&&"disabled",e&&"fullWidth",`size${O(p)}`,u]};return Y(c,Qa,t)},tt=D(fa,{name:"MuiToggleButton",slot:"Root",overridesResolver:(a,t)=>{const{ownerState:e}=a;return[t.root,t[`size${O(e.size)}`]]}})(({theme:a,ownerState:t})=>{let e=t.color==="standard"?a.palette.text.primary:a.palette[t.color].main,s;return a.vars&&(e=t.color==="standard"?a.vars.palette.text.primary:a.vars.palette[t.color].main,s=t.color==="standard"?a.vars.palette.text.primaryChannel:a.vars.palette[t.color].mainChannel),y({},a.typography.button,{borderRadius:(a.vars||a).shape.borderRadius,padding:11,border:`1px solid ${(a.vars||a).palette.divider}`,color:(a.vars||a).palette.action.active},t.fullWidth&&{width:"100%"},{[`&.${E.disabled}`]:{color:(a.vars||a).palette.action.disabled,border:`1px solid ${(a.vars||a).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / ${a.vars.palette.action.hoverOpacity})`:J(a.palette.text.primary,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${E.selected}`]:{color:e,backgroundColor:a.vars?`rgba(${s} / ${a.vars.palette.action.selectedOpacity})`:J(e,a.palette.action.selectedOpacity),"&:hover":{backgroundColor:a.vars?`rgba(${s} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.hoverOpacity}))`:J(e,a.palette.action.selectedOpacity+a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:a.vars?`rgba(${s} / ${a.vars.palette.action.selectedOpacity})`:J(e,a.palette.action.selectedOpacity)}}}},t.size==="small"&&{padding:7,fontSize:a.typography.pxToRem(13)},t.size==="large"&&{padding:15,fontSize:a.typography.pxToRem(15)})}),ga=h.forwardRef(function(t,e){const s=h.useContext(ba),{value:f}=s,p=S(s,Ya),u=h.useContext(ha),c=za(y({},p,{selected:Xa(t.value,f)}),t),v=X({props:c,name:"MuiToggleButton"}),{children:z,className:m,color:j="standard",disabled:R=!1,disableFocusRipple:l=!1,fullWidth:g=!1,onChange:_,onClick:b,selected:B,size:I="medium",value:P}=v,T=S(v,Za),M=y({},v,{color:j,disabled:R,disableFocusRipple:l,fullWidth:g,size:I}),L=at(M),C=i=>{b&&(b(i,P),i.defaultPrevented)||_&&_(i,P)},d=u||"";return o.jsx(tt,y({className:q(p.className,L.root,m,d),disabled:R,focusRipple:!l,ref:e,onClick:C,onChange:_,value:P,ownerState:M,"aria-pressed":B},T,{children:z}))});function et(a){return K("MuiToggleButtonGroup",a)}const x=Q("MuiToggleButtonGroup",["root","selected","horizontal","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth","firstButton","lastButton","middleButton"]),ot=["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"],st=a=>{const{classes:t,orientation:e,fullWidth:s,disabled:f}=a,p={root:["root",e==="vertical"&&"vertical",s&&"fullWidth"],grouped:["grouped",`grouped${O(e)}`,f&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return Y(p,et,t)},rt=D("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(a,t)=>{const{ownerState:e}=a;return[{[`& .${x.grouped}`]:t.grouped},{[`& .${x.grouped}`]:t[`grouped${O(e.orientation)}`]},{[`& .${x.firstButton}`]:t.firstButton},{[`& .${x.lastButton}`]:t.lastButton},{[`& .${x.middleButton}`]:t.middleButton},t.root,e.orientation==="vertical"&&t.vertical,e.fullWidth&&t.fullWidth]}})(({ownerState:a,theme:t})=>y({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius},a.orientation==="vertical"&&{flexDirection:"column"},a.fullWidth&&{width:"100%"},{[`& .${x.grouped}`]:y({},a.orientation==="horizontal"?{[`&.${x.selected} + .${x.grouped}.${x.selected}`]:{borderLeft:0,marginLeft:0}}:{[`&.${x.selected} + .${x.grouped}.${x.selected}`]:{borderTop:0,marginTop:0}})},a.orientation==="horizontal"?{[`& .${x.firstButton},& .${x.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${x.lastButton},& .${x.middleButton}`]:{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0}}:{[`& .${x.firstButton},& .${x.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${x.lastButton},& .${x.middleButton}`]:{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0}},a.orientation==="horizontal"?{[`& .${x.lastButton}.${E.disabled},& .${x.middleButton}.${E.disabled}`]:{borderLeft:"1px solid transparent"}}:{[`& .${x.lastButton}.${E.disabled},& .${x.middleButton}.${E.disabled}`]:{borderTop:"1px solid transparent"}})),nt=h.forwardRef(function(t,e){const s=X({props:t,name:"MuiToggleButtonGroup"}),{children:f,className:p,color:u="standard",disabled:c=!1,exclusive:v=!1,fullWidth:z=!1,onChange:m,orientation:j="horizontal",size:R="medium",value:l}=s,g=S(s,ot),_=y({},s,{disabled:c,fullWidth:z,orientation:j,size:R}),b=st(_),B=h.useCallback((C,d)=>{if(!m)return;const i=l&&l.indexOf(d);let k;l&&i>=0?(k=l.slice(),k.splice(i,1)):k=l?l.concat(d):[d],m(C,k)},[m,l]),I=h.useCallback((C,d)=>{m&&m(C,l===d?null:d)},[m,l]),P=h.useMemo(()=>({className:b.grouped,onChange:v?I:B,value:l,size:R,fullWidth:z,color:u,disabled:c}),[b.grouped,v,I,B,l,R,z,u,c]),T=Ia(f),M=T.length,L=C=>{const d=C===0,i=C===M-1;return d&&i?"":d?b.firstButton:i?b.lastButton:b.middleButton};return o.jsx(rt,y({role:"group",className:q(b.root,p),ref:e,ownerState:_},g,{children:o.jsx(ba.Provider,{value:P,children:T.map((C,d)=>o.jsx(ha.Provider,{value:L(d),children:C},d))})}))}),it=F(o.jsx("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z"}),"ArrowDownward"),lt=F(o.jsx("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"}),"ArrowUpward"),ct=F(o.jsx("path",{d:"M3 14h4v-4H3zm0 5h4v-4H3zM3 9h4V5H3zm5 5h13v-4H8zm0 5h13v-4H8zM8 5v4h13V5z"}),"ViewList"),dt=F(o.jsx("path",{d:"M14.67 5v6.5H9.33V5zm1 6.5H21V5h-5.33zm-1 7.5v-6.5H9.33V19zm1-6.5V19H21v-6.5zm-7.34 0H3V19h5.33zm0-1V5H3v6.5z"}),"ViewModule"),ut=h.lazy(()=>va(()=>import("./PackageCard-Dljv0P3o.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),pt=h.lazy(()=>va(()=>import("./PackageList-DkuzFPk6.js"),__vite__mapDeps([8,1,2,3,4,5,6])));async function gt(a,t,e=1e3){let s=[],f=0,p=!0;for(;p;){const{data:u,error:c,count:v}=await a.select(t,{count:"exact"}).range(f,f+e-1);if(c)throw console.error("Error fetching paginated data:",c.message),c;u&&u.length>0?(s=s.concat(u),f+=u.length):p=!1,v!==null&&f>=v&&(p=!1),u&&u.length<e&&(p=!1)}return s}const xt=()=>{const{searchTerm:a,selectedTags:t,minStars:e,hasGithub:s,hasWebserver:f,hasPublication:p,minCitations:u,folder1:c,category1:v,selectedLicenses:z,sortBy:m,sortDirection:j,viewMode:R,currentPage:l,totalFilteredCount:g}=U(ra(n=>({searchTerm:n.searchTerm,selectedTags:n.selectedTags,minStars:n.minStars,hasGithub:n.hasGithub,hasWebserver:n.hasWebserver,hasPublication:n.hasPublication,minCitations:n.minCitations,folder1:n.folder1,category1:n.category1,selectedLicenses:n.selectedLicenses,sortBy:n.sortBy,sortDirection:n.sortDirection,viewMode:n.viewMode,currentPage:n.currentPage,totalFilteredCount:n.totalFilteredCount}))),{setSort:_,setDisplayedPackages:b,setTotalFilteredCount:B,setViewMode:I,setCurrentPage:P,setOriginalPackagesAndDeriveMetadata:T}=U(ra(n=>({setSort:n.setSort,setDisplayedPackages:n.setDisplayedPackages,setTotalFilteredCount:n.setTotalFilteredCount,setViewMode:n.setViewMode,setCurrentPage:n.setCurrentPage,setOriginalPackagesAndDeriveMetadata:n.setOriginalPackagesAndDeriveMetadata}))),[M,L]=h.useState([]),[C,d]=h.useState(!0),[i,k]=h.useState(""),H=24;h.useEffect(()=>{(async()=>{k(""),d(!0);try{const V=await gt(la.from("packages"),"id, package_name, description, tags, license, github_stars, citations, repo_link, webserver, publication, folder1, category1, last_commit, average_rating, ratings_count, github_owner, github_repo, jif, journal, last_commit_ago, link, page_icon, primary_language, ratings_sum");V?T(V):(T([]),k("No packages found for metadata."))}catch($){console.error("Error in fetchGlobalDataAndSetMetadata:",$.message),k("An unexpected error occurred while loading filter options."),T([])}finally{d(!1)}})()},[T]),h.useEffect(()=>La.subscribe($=>{console.log(`HomePage received rating update for package ${$.packageId}: ${$.averageRating} (${$.ratingsCount} ratings)`),L(r=>r.map(W=>W.id===$.packageId?{...W,average_rating:$.averageRating,ratings_count:$.ratingsCount}:W));const aa=U.getState().displayedPackages.map(r=>r.id===$.packageId?{...r,average_rating:$.averageRating,ratings_count:$.ratingsCount}:r);b(aa)}),[b]),h.useEffect(()=>{(async()=>{U.getState().allAvailableFolders.length===0&&U.getState().originalPackages.length,d(!0),k("");const V=(l-1)*H,aa=V+H-1;try{let r=la.from("packages").select("*, average_rating, ratings_count",{count:"exact"});if(a&&(r=r.or(`package_name.ilike.%${a}%,description.ilike.%${a}%`)),t.length>0){const Pa=JSON.stringify(t);r=r.contains("tags",Pa)}e!==null&&e>0&&(r=r.gte("github_stars",e)),s&&(r=r.not("repo_link","is",null)),f&&(r=r.not("webserver","is",null)),p&&(r=r.not("publication","is",null)),u!==null&&u>0&&(r=r.gte("citations",u)),c&&(r=r.eq("folder1",c)),v&&(r=r.eq("category1",v)),z.length>0&&(r=r.in("license",z)),m&&j?r=r.order(m,{ascending:j==="asc",nullsFirst:!1}):r=r.order("package_name",{ascending:!0,nullsFirst:!1}),r=r.range(V,aa);const{data:W,error:sa,count:$a}=await r;if(sa)throw sa;W?(L(W),b(W)):(L([]),b([])),B($a??0)}catch(r){k(`Failed to fetch packages: ${(r==null?void 0:r.message)||"Unknown error"}`),console.error("Error fetching packages from Supabase:",r),L([]),b([]),B(0)}finally{d(!1)}})()},[l,a,t,e,s,f,p,u,c,v,z,m,j,b,B]);const ea=(n,$)=>{P($),window.scrollTo(0,0)},Z=n=>{const $=n.target.value;P(1),_($===""?null:$,j)},ya=()=>{P(1),_(m,j==="asc"?"desc":"asc")},ma=(n,$)=>{$!==null&&I($)},Ca=o.jsx(w,{display:"flex",justifyContent:"center",py:4,children:o.jsx(na,{})}),oa=Math.ceil(g/H);return o.jsxs(Ra,{maxWidth:"lg",sx:{pt:2,px:{xs:1,sm:2},pb:0},children:[C&&o.jsx(w,{display:"flex",justifyContent:"center",py:4,children:o.jsx(na,{})}),i&&!C&&o.jsx(w,{py:4,children:o.jsx(ja,{severity:"error",children:i})}),o.jsxs(w,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,flexWrap:"wrap",gap:1},children:[o.jsxs(ta,{variant:"h4",component:"h1",sx:{mb:{xs:1,sm:0},color:"text.primary",fontWeight:500,letterSpacing:"-0.01em"},children:[g," Entries Found"]}),o.jsxs(w,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[o.jsx(ta,{variant:"body2",sx:{mr:1,minWidth:55,color:"text.secondary"},children:"Sort by:"}),o.jsx(Ma,{size:"small",variant:"outlined",sx:{minWidth:150},children:o.jsxs(_a,{id:"sort-by-select",name:"sortBy",value:m??"",displayEmpty:!0,onChange:Z,MenuProps:{PaperProps:{sx:{mt:1,borderRadius:2,minWidth:180}}},children:[o.jsx(G,{value:"package_name",children:"Name"}),o.jsx(G,{value:"average_rating",children:"Rating"}),o.jsx(G,{value:"ratings_count",children:"Number of Ratings"}),o.jsx(G,{value:"github_stars",children:"GitHub Stars"}),o.jsx(G,{value:"citations",children:"Citations"}),o.jsx(G,{value:"last_commit",children:"Last Commit"})]})}),o.jsx(Ta,{onClick:ya,size:"small","aria-label":"toggle sort direction",sx:{border:"1px solid",borderColor:"divider",ml:1,background:n=>n.palette.mode==="dark"?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.04)","&:hover":{background:n=>n.palette.action.hover}},children:j==="asc"?o.jsx(lt,{fontSize:"small"}):o.jsx(it,{fontSize:"small"})}),o.jsxs(nt,{value:R,exclusive:!0,onChange:ma,"aria-label":"view mode",size:"small",sx:{ml:{sm:2},background:"transparent",borderRadius:2},children:[o.jsx(ga,{value:"card","aria-label":"card view",sx:{borderRadius:1,px:1.5},children:o.jsx(dt,{})}),o.jsx(ga,{value:"list","aria-label":"list view",sx:{borderRadius:1,px:1.5},children:o.jsx(ct,{})})]})]})]}),!C&&!i&&o.jsx(h.Suspense,{fallback:Ca,children:R==="card"?o.jsxs(h.Fragment,{children:[o.jsx(ia,{container:!0,spacing:2,sx:{p:0},children:M.map(n=>o.jsx(ia,{item:!0,xs:12,sm:6,md:4,lg:3,children:o.jsx(ut,{pkg:n})},n.id))}),oa>1&&o.jsx(w,{sx:{display:"flex",justifyContent:"center",mt:4,mb:2},children:o.jsx(Ka,{count:oa,page:l,onChange:ea,color:"primary"})})]}):o.jsx(pt,{packages:M})}),!C&&!i&&M.length===0&&g===0&&o.jsx(w,{sx:{textAlign:"center",mt:4,py:4},children:o.jsx(ta,{variant:"h6",color:"text.secondary",children:"No packages found matching your criteria."})})]})};export{xt as default};
