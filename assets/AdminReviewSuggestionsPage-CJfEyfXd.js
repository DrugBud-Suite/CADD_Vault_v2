import{g as we,a as ke,r as a,u as je,_ as xe,c as m,j as o,s as J,d as ae,ak as jt,al as Bt,e as L,f as Be,am as rt,m as Z,an as Et,U as zt,ao as Rt,ap as $t,aq as Re,ar as Ye,as as Tt,at,X as mt,p as vt,au as Mt,av as Te,B as xt,aw as Lt,ax as gt,ay as yt,az as Ct,W as It,v as Pt,aA as ce,n as se,t as me,y as Ee,C as lt,A as et,T as U,L as Se,aB as _t,aC as Ge,Z as At,Q as it,I as ve,ah as Wt}from"./index-QxSUAMeM.js";import{T as Ot,a as Dt,b as Ft,c as ct,d as X,e as Nt,E as Ht}from"./EditSuggestionModal-DZWTCIVe.js";import{g as Vt}from"./getValidReactChildren-CO-yNIWJ.js";import{L as Gt,A as Ut}from"./Language-D-B4rR1C.js";import{E as Xt,D as Yt,a as Kt,b as qt,c as Qt,d as Jt}from"./Edit-DjL1CPvw.js";import"./Grid-D4ArmYgK.js";let ze;function St(){if(ze)return ze;const t=document.createElement("div"),e=document.createElement("div");return e.style.width="10px",e.style.height="1px",t.appendChild(e),t.dir="rtl",t.style.fontSize="14px",t.style.width="4px",t.style.height="1px",t.style.position="absolute",t.style.top="-1000px",t.style.overflow="scroll",document.body.appendChild(t),ze="reverse",t.scrollLeft>0?ze="default":(t.scrollLeft=1,t.scrollLeft===0&&(ze="negative")),document.body.removeChild(t),ze}function Zt(t,e){const r=t.scrollLeft;if(e!=="rtl")return r;switch(St()){case"negative":return t.scrollWidth-t.clientWidth+r;case"reverse":return t.scrollWidth-t.clientWidth-r;default:return r}}function eo(t){return ke("MuiButtonGroup",t)}const _=we("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","vertical","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),to=["children","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"],oo=(t,e)=>{const{ownerState:r}=t;return[{[`& .${_.grouped}`]:e.grouped},{[`& .${_.grouped}`]:e[`grouped${L(r.orientation)}`]},{[`& .${_.grouped}`]:e[`grouped${L(r.variant)}`]},{[`& .${_.grouped}`]:e[`grouped${L(r.variant)}${L(r.orientation)}`]},{[`& .${_.grouped}`]:e[`grouped${L(r.variant)}${L(r.color)}`]},{[`& .${_.firstButton}`]:e.firstButton},{[`& .${_.lastButton}`]:e.lastButton},{[`& .${_.middleButton}`]:e.middleButton},e.root,e[r.variant],r.disableElevation===!0&&e.disableElevation,r.fullWidth&&e.fullWidth,r.orientation==="vertical"&&e.vertical]},no=t=>{const{classes:e,color:r,disabled:s,disableElevation:l,fullWidth:i,orientation:b,variant:p}=t,d={root:["root",p,b==="vertical"&&"vertical",i&&"fullWidth",l&&"disableElevation"],grouped:["grouped",`grouped${L(b)}`,`grouped${L(p)}`,`grouped${L(p)}${L(b)}`,`grouped${L(p)}${L(r)}`,s&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return Be(d,eo,e)},ro=J("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:oo})(({theme:t,ownerState:e})=>m({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[2]},e.disableElevation&&{boxShadow:"none"},e.fullWidth&&{width:"100%"},e.orientation==="vertical"&&{flexDirection:"column"},{[`& .${_.grouped}`]:m({minWidth:40,"&:hover":m({},e.variant==="contained"&&{boxShadow:"none"})},e.variant==="contained"&&{boxShadow:"none"}),[`& .${_.firstButton},& .${_.middleButton}`]:m({},e.orientation==="horizontal"&&{borderTopRightRadius:0,borderBottomRightRadius:0},e.orientation==="vertical"&&{borderBottomRightRadius:0,borderBottomLeftRadius:0},e.variant==="text"&&e.orientation==="horizontal"&&{borderRight:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${_.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}},e.variant==="text"&&e.orientation==="vertical"&&{borderBottom:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${_.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}},e.variant==="text"&&e.color!=="inherit"&&{borderColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / 0.5)`:rt.alpha(t.palette[e.color].main,.5)},e.variant==="outlined"&&e.orientation==="horizontal"&&{borderRightColor:"transparent"},e.variant==="outlined"&&e.orientation==="vertical"&&{borderBottomColor:"transparent"},e.variant==="contained"&&e.orientation==="horizontal"&&{borderRight:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${_.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}},e.variant==="contained"&&e.orientation==="vertical"&&{borderBottom:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${_.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}},e.variant==="contained"&&e.color!=="inherit"&&{borderColor:(t.vars||t).palette[e.color].dark},{"&:hover":m({},e.variant==="outlined"&&e.orientation==="horizontal"&&{borderRightColor:"currentColor"},e.variant==="outlined"&&e.orientation==="vertical"&&{borderBottomColor:"currentColor"})}),[`& .${_.lastButton},& .${_.middleButton}`]:m({},e.orientation==="horizontal"&&{borderTopLeftRadius:0,borderBottomLeftRadius:0},e.orientation==="vertical"&&{borderTopRightRadius:0,borderTopLeftRadius:0},e.variant==="outlined"&&e.orientation==="horizontal"&&{marginLeft:-1},e.variant==="outlined"&&e.orientation==="vertical"&&{marginTop:-1})})),so=a.forwardRef(function(e,r){const s=je({props:e,name:"MuiButtonGroup"}),{children:l,className:i,color:b="primary",component:p="div",disabled:d=!1,disableElevation:x=!1,disableFocusRipple:y=!1,disableRipple:w=!1,fullWidth:B=!1,orientation:S="horizontal",size:j="medium",variant:h="outlined"}=s,v=xe(s,to),g=m({},s,{color:b,component:p,disabled:d,disableElevation:x,disableFocusRipple:y,disableRipple:w,fullWidth:B,orientation:S,size:j,variant:h}),u=no(g),R=a.useMemo(()=>({className:u.grouped,color:b,disabled:d,disableElevation:x,disableFocusRipple:y,disableRipple:w,fullWidth:B,size:j,variant:h}),[b,d,x,y,w,B,j,h,u.grouped]),N=Vt(l),Y=N.length,K=I=>{const W=I===0,O=I===Y-1;return W&&O?"":W?u.firstButton:O?u.lastButton:u.middleButton};return o.jsx(ro,m({as:p,role:"group",className:ae(u.root,i),ref:r,ownerState:g},v,{children:o.jsx(jt.Provider,{value:R,children:N.map((I,W)=>o.jsx(Bt.Provider,{value:K(W),children:I},W))})}))}),ao=Z(o.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),lo=Z(o.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),io=Z(o.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function co(t){return ke("MuiCheckbox",t)}const tt=we("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),uo=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],po=t=>{const{classes:e,indeterminate:r,color:s,size:l}=t,i={root:["root",r&&"indeterminate",`color${L(s)}`,`size${L(l)}`]},b=Be(i,co,e);return m({},e,b)},fo=J(Et,{shouldForwardProp:t=>zt(t)||t==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.indeterminate&&e.indeterminate,e[`size${L(r.size)}`],r.color!=="default"&&e[`color${L(r.color)}`]]}})(({theme:t,ownerState:e})=>m({color:(t.vars||t).palette.text.secondary},!e.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${e.color==="default"?t.vars.palette.action.activeChannel:t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:rt.alpha(e.color==="default"?t.palette.action.active:t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.color!=="default"&&{[`&.${tt.checked}, &.${tt.indeterminate}`]:{color:(t.vars||t).palette[e.color].main},[`&.${tt.disabled}`]:{color:(t.vars||t).palette.action.disabled}})),ho=o.jsx(lo,{}),bo=o.jsx(ao,{}),mo=o.jsx(io,{}),ot=a.forwardRef(function(e,r){var s,l;const i=je({props:e,name:"MuiCheckbox"}),{checkedIcon:b=ho,color:p="primary",icon:d=bo,indeterminate:x=!1,indeterminateIcon:y=mo,inputProps:w,size:B="medium",className:S}=i,j=xe(i,uo),h=x?y:d,v=x?y:b,g=m({},i,{color:p,indeterminate:x,size:B}),u=po(g);return o.jsx(fo,m({type:"checkbox",inputProps:m({"data-indeterminate":x},w),icon:a.cloneElement(h,{fontSize:(s=h.props.fontSize)!=null?s:B}),checkedIcon:a.cloneElement(v,{fontSize:(l=v.props.fontSize)!=null?l:B}),ownerState:g,ref:r,className:ae(u.root,S)},j,{classes:u}))});function dt(t){return t.substring(2).toLowerCase()}function vo(t,e){return e.documentElement.clientWidth<t.clientX||e.documentElement.clientHeight<t.clientY}function xo(t){const{children:e,disableReactTree:r=!1,mouseEvent:s="onClick",onClickAway:l,touchEvent:i="onTouchEnd"}=t,b=a.useRef(!1),p=a.useRef(null),d=a.useRef(!1),x=a.useRef(!1);a.useEffect(()=>(setTimeout(()=>{d.current=!0},0),()=>{d.current=!1}),[]);const y=Rt($t(e),p),w=Re(j=>{const h=x.current;x.current=!1;const v=Ye(p.current);if(!d.current||!p.current||"clientX"in j&&vo(j,v))return;if(b.current){b.current=!1;return}let g;j.composedPath?g=j.composedPath().indexOf(p.current)>-1:g=!v.documentElement.contains(j.target)||p.current.contains(j.target),!g&&(r||!h)&&l(j)}),B=j=>h=>{x.current=!0;const v=e.props[j];v&&v(h)},S={ref:y};return i!==!1&&(S[i]=B(i)),a.useEffect(()=>{if(i!==!1){const j=dt(i),h=Ye(p.current),v=()=>{b.current=!0};return h.addEventListener(j,w),h.addEventListener("touchmove",v),()=>{h.removeEventListener(j,w),h.removeEventListener("touchmove",v)}}},[w,i]),s!==!1&&(S[s]=B(s)),a.useEffect(()=>{if(s!==!1){const j=dt(s),h=Ye(p.current);return h.addEventListener(j,w),()=>{h.removeEventListener(j,w)}}},[w,s]),o.jsx(a.Fragment,{children:a.cloneElement(e,S)})}function go(t={}){const{autoHideDuration:e=null,disableWindowBlurListener:r=!1,onClose:s,open:l,resumeHideDuration:i}=t,b=Tt();a.useEffect(()=>{if(!l)return;function g(u){u.defaultPrevented||(u.key==="Escape"||u.key==="Esc")&&(s==null||s(u,"escapeKeyDown"))}return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[l,s]);const p=Re((g,u)=>{s==null||s(g,u)}),d=Re(g=>{!s||g==null||b.start(g,()=>{p(null,"timeout")})});a.useEffect(()=>(l&&d(e),b.clear),[l,e,d,b]);const x=g=>{s==null||s(g,"clickaway")},y=b.clear,w=a.useCallback(()=>{e!=null&&d(i??e*.5)},[e,i,d]),B=g=>u=>{const R=g.onBlur;R==null||R(u),w()},S=g=>u=>{const R=g.onFocus;R==null||R(u),y()},j=g=>u=>{const R=g.onMouseEnter;R==null||R(u),y()},h=g=>u=>{const R=g.onMouseLeave;R==null||R(u),w()};return a.useEffect(()=>{if(!r&&l)return window.addEventListener("focus",w),window.addEventListener("blur",y),()=>{window.removeEventListener("focus",w),window.removeEventListener("blur",y)}},[r,l,w,y]),{getRootProps:(g={})=>{const u=m({},at(t),at(g));return m({role:"presentation"},g,u,{onBlur:B(u),onFocus:S(u),onMouseEnter:j(u),onMouseLeave:h(u)})},onClickAway:x}}function yo(t){return ke("MuiSnackbarContent",t)}we("MuiSnackbarContent",["root","message","action"]);const Co=["action","className","message","role"],So=t=>{const{classes:e}=t;return Be({root:["root"],action:["action"],message:["message"]},yo,e)},wo=J(mt,{name:"MuiSnackbarContent",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t})=>{const e=t.palette.mode==="light"?.8:.98,r=rt.emphasize(t.palette.background.default,e);return m({},t.typography.body2,{color:t.vars?t.vars.palette.SnackbarContent.color:t.palette.getContrastText(r),backgroundColor:t.vars?t.vars.palette.SnackbarContent.bg:r,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,flexGrow:1,[t.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}})}),ko=J("div",{name:"MuiSnackbarContent",slot:"Message",overridesResolver:(t,e)=>e.message})({padding:"8px 0"}),jo=J("div",{name:"MuiSnackbarContent",slot:"Action",overridesResolver:(t,e)=>e.action})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),Bo=a.forwardRef(function(e,r){const s=je({props:e,name:"MuiSnackbarContent"}),{action:l,className:i,message:b,role:p="alert"}=s,d=xe(s,Co),x=s,y=So(x);return o.jsxs(wo,m({role:p,square:!0,elevation:6,className:ae(y.root,i),ownerState:x,ref:r},d,{children:[o.jsx(ko,{className:y.message,ownerState:x,children:b}),l?o.jsx(jo,{className:y.action,ownerState:x,children:l}):null]}))});function Eo(t){return ke("MuiSnackbar",t)}we("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const zo=["onEnter","onExited"],Ro=["action","anchorOrigin","autoHideDuration","children","className","ClickAwayListenerProps","ContentProps","disableWindowBlurListener","message","onBlur","onClose","onFocus","onMouseEnter","onMouseLeave","open","resumeHideDuration","TransitionComponent","transitionDuration","TransitionProps"],$o=t=>{const{classes:e,anchorOrigin:r}=t,s={root:["root",`anchorOrigin${L(r.vertical)}${L(r.horizontal)}`]};return Be(s,Eo,e)},ut=J("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`anchorOrigin${L(r.anchorOrigin.vertical)}${L(r.anchorOrigin.horizontal)}`]]}})(({theme:t,ownerState:e})=>{const r={left:"50%",right:"auto",transform:"translateX(-50%)"};return m({zIndex:(t.vars||t).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center"},e.anchorOrigin.vertical==="top"?{top:8}:{bottom:8},e.anchorOrigin.horizontal==="left"&&{justifyContent:"flex-start"},e.anchorOrigin.horizontal==="right"&&{justifyContent:"flex-end"},{[t.breakpoints.up("sm")]:m({},e.anchorOrigin.vertical==="top"?{top:24}:{bottom:24},e.anchorOrigin.horizontal==="center"&&r,e.anchorOrigin.horizontal==="left"&&{left:24,right:"auto"},e.anchorOrigin.horizontal==="right"&&{right:24,left:"auto"})})}),To=a.forwardRef(function(e,r){const s=je({props:e,name:"MuiSnackbar"}),l=vt(),i={enter:l.transitions.duration.enteringScreen,exit:l.transitions.duration.leavingScreen},{action:b,anchorOrigin:{vertical:p,horizontal:d}={vertical:"bottom",horizontal:"left"},autoHideDuration:x=null,children:y,className:w,ClickAwayListenerProps:B,ContentProps:S,disableWindowBlurListener:j=!1,message:h,open:v,TransitionComponent:g=Mt,transitionDuration:u=i,TransitionProps:{onEnter:R,onExited:N}={}}=s,Y=xe(s.TransitionProps,zo),K=xe(s,Ro),I=m({},s,{anchorOrigin:{vertical:p,horizontal:d},autoHideDuration:x,disableWindowBlurListener:j,TransitionComponent:g,transitionDuration:u}),W=$o(I),{getRootProps:O,onClickAway:q}=go(m({},I)),[ue,$]=a.useState(!0),H=Te({elementType:ut,getSlotProps:O,externalForwardedProps:K,ownerState:I,additionalProps:{ref:r},className:[W.root,w]}),k=ee=>{$(!0),N&&N(ee)},A=(ee,D)=>{$(!1),R&&R(ee,D)};return!v&&ue?null:o.jsx(xo,m({onClickAway:q},B,{children:o.jsx(ut,m({},H,{children:o.jsx(g,m({appear:!0,in:v,timeout:u,direction:p==="top"?"down":"up",onEnter:A,onExited:k},Y,{children:y||o.jsx(Bo,m({message:h,action:b},S))}))}))}))});function Mo(t){return ke("MuiTab",t)}const ye=we("MuiTab",["root","labelIcon","textColorInherit","textColorPrimary","textColorSecondary","selected","disabled","fullWidth","wrapped","iconWrapper"]),Lo=["className","disabled","disableFocusRipple","fullWidth","icon","iconPosition","indicator","label","onChange","onClick","onFocus","selected","selectionFollowsFocus","textColor","value","wrapped"],Io=t=>{const{classes:e,textColor:r,fullWidth:s,wrapped:l,icon:i,label:b,selected:p,disabled:d}=t,x={root:["root",i&&b&&"labelIcon",`textColor${L(r)}`,s&&"fullWidth",l&&"wrapped",p&&"selected",d&&"disabled"],iconWrapper:["iconWrapper"]};return Be(x,Mo,e)},Po=J(xt,{name:"MuiTab",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.label&&r.icon&&e.labelIcon,e[`textColor${L(r.textColor)}`],r.fullWidth&&e.fullWidth,r.wrapped&&e.wrapped,{[`& .${ye.iconWrapper}`]:e.iconWrapper}]}})(({theme:t,ownerState:e})=>m({},t.typography.button,{maxWidth:360,minWidth:90,position:"relative",minHeight:48,flexShrink:0,padding:"12px 16px",overflow:"hidden",whiteSpace:"normal",textAlign:"center"},e.label&&{flexDirection:e.iconPosition==="top"||e.iconPosition==="bottom"?"column":"row"},{lineHeight:1.25},e.icon&&e.label&&{minHeight:72,paddingTop:9,paddingBottom:9,[`& > .${ye.iconWrapper}`]:m({},e.iconPosition==="top"&&{marginBottom:6},e.iconPosition==="bottom"&&{marginTop:6},e.iconPosition==="start"&&{marginRight:t.spacing(1)},e.iconPosition==="end"&&{marginLeft:t.spacing(1)})},e.textColor==="inherit"&&{color:"inherit",opacity:.6,[`&.${ye.selected}`]:{opacity:1},[`&.${ye.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity}},e.textColor==="primary"&&{color:(t.vars||t).palette.text.secondary,[`&.${ye.selected}`]:{color:(t.vars||t).palette.primary.main},[`&.${ye.disabled}`]:{color:(t.vars||t).palette.text.disabled}},e.textColor==="secondary"&&{color:(t.vars||t).palette.text.secondary,[`&.${ye.selected}`]:{color:(t.vars||t).palette.secondary.main},[`&.${ye.disabled}`]:{color:(t.vars||t).palette.text.disabled}},e.fullWidth&&{flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:"none"},e.wrapped&&{fontSize:t.typography.pxToRem(12)})),Ue=a.forwardRef(function(e,r){const s=je({props:e,name:"MuiTab"}),{className:l,disabled:i=!1,disableFocusRipple:b=!1,fullWidth:p,icon:d,iconPosition:x="top",indicator:y,label:w,onChange:B,onClick:S,onFocus:j,selected:h,selectionFollowsFocus:v,textColor:g="inherit",value:u,wrapped:R=!1}=s,N=xe(s,Lo),Y=m({},s,{disabled:i,disableFocusRipple:b,selected:h,icon:!!d,iconPosition:x,label:!!w,fullWidth:p,textColor:g,wrapped:R}),K=Io(Y),I=d&&w&&a.isValidElement(d)?a.cloneElement(d,{className:ae(K.iconWrapper,d.props.className)}):d,W=q=>{!h&&B&&B(q,u),S&&S(q)},O=q=>{v&&!h&&B&&B(q,u),j&&j(q)};return o.jsxs(Po,m({focusRipple:!b,className:ae(K.root,l),ref:r,role:"tab","aria-selected":h,disabled:i,onClick:W,onFocus:O,ownerState:Y,tabIndex:h?0:-1},N,{children:[x==="top"||x==="start"?o.jsxs(a.Fragment,{children:[I,w]}):o.jsxs(a.Fragment,{children:[w,I]}),y]}))}),_o=Z(o.jsx("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft"),Ao=Z(o.jsx("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight");function Wo(t){return(1+Math.sin(Math.PI*t-Math.PI/2))/2}function Oo(t,e,r,s={},l=()=>{}){const{ease:i=Wo,duration:b=300}=s;let p=null;const d=e[t];let x=!1;const y=()=>{x=!0},w=B=>{if(x){l(new Error("Animation cancelled"));return}p===null&&(p=B);const S=Math.min(1,(B-p)/b);if(e[t]=i(S)*(r-d)+d,S>=1){requestAnimationFrame(()=>{l(null)});return}requestAnimationFrame(w)};return d===r?(l(new Error("Element already at target position")),y):(requestAnimationFrame(w),y)}const Do=["onChange"],Fo={width:99,height:99,position:"absolute",top:-9999,overflow:"scroll"};function No(t){const{onChange:e}=t,r=xe(t,Do),s=a.useRef(),l=a.useRef(null),i=()=>{s.current=l.current.offsetHeight-l.current.clientHeight};return Lt(()=>{const b=gt(()=>{const d=s.current;i(),d!==s.current&&e(s.current)}),p=yt(l.current);return p.addEventListener("resize",b),()=>{b.clear(),p.removeEventListener("resize",b)}},[e]),a.useEffect(()=>{i(),e(s.current)},[e]),o.jsx("div",m({style:Fo},r,{ref:l}))}function Ho(t){return ke("MuiTabScrollButton",t)}const Vo=we("MuiTabScrollButton",["root","vertical","horizontal","disabled"]),Go=["className","slots","slotProps","direction","orientation","disabled"],Uo=t=>{const{classes:e,orientation:r,disabled:s}=t;return Be({root:["root",r,s&&"disabled"]},Ho,e)},Xo=J(xt,{name:"MuiTabScrollButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.orientation&&e[r.orientation]]}})(({ownerState:t})=>m({width:40,flexShrink:0,opacity:.8,[`&.${Vo.disabled}`]:{opacity:0}},t.orientation==="vertical"&&{width:"100%",height:40,"& svg":{transform:`rotate(${t.isRtl?-90:90}deg)`}})),Yo=a.forwardRef(function(e,r){var s,l;const i=je({props:e,name:"MuiTabScrollButton"}),{className:b,slots:p={},slotProps:d={},direction:x}=i,y=xe(i,Go),w=Ct(),B=m({isRtl:w},i),S=Uo(B),j=(s=p.StartScrollButtonIcon)!=null?s:_o,h=(l=p.EndScrollButtonIcon)!=null?l:Ao,v=Te({elementType:j,externalSlotProps:d.startScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:B}),g=Te({elementType:h,externalSlotProps:d.endScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:B});return o.jsx(Xo,m({component:"div",className:ae(S.root,b),ref:r,role:null,ownerState:B,tabIndex:null},y,{children:x==="left"?o.jsx(j,m({},v)):o.jsx(h,m({},g))}))});function Ko(t){return ke("MuiTabs",t)}const nt=we("MuiTabs",["root","vertical","flexContainer","flexContainerVertical","centered","scroller","fixed","scrollableX","scrollableY","hideScrollbar","scrollButtons","scrollButtonsHideMobile","indicator"]),qo=["aria-label","aria-labelledby","action","centered","children","className","component","allowScrollButtonsMobile","indicatorColor","onChange","orientation","ScrollButtonComponent","scrollButtons","selectionFollowsFocus","slots","slotProps","TabIndicatorProps","TabScrollButtonProps","textColor","value","variant","visibleScrollbar"],pt=(t,e)=>t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:t.firstChild,ft=(t,e)=>t===e?t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:t.lastChild,Xe=(t,e,r)=>{let s=!1,l=r(t,e);for(;l;){if(l===t.firstChild){if(s)return;s=!0}const i=l.disabled||l.getAttribute("aria-disabled")==="true";if(!l.hasAttribute("tabindex")||i)l=r(t,l);else{l.focus();return}}},Qo=t=>{const{vertical:e,fixed:r,hideScrollbar:s,scrollableX:l,scrollableY:i,centered:b,scrollButtonsHideMobile:p,classes:d}=t;return Be({root:["root",e&&"vertical"],scroller:["scroller",r&&"fixed",s&&"hideScrollbar",l&&"scrollableX",i&&"scrollableY"],flexContainer:["flexContainer",e&&"flexContainerVertical",b&&"centered"],indicator:["indicator"],scrollButtons:["scrollButtons",p&&"scrollButtonsHideMobile"],scrollableX:[l&&"scrollableX"],hideScrollbar:[s&&"hideScrollbar"]},Ko,d)},Jo=J("div",{name:"MuiTabs",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${nt.scrollButtons}`]:e.scrollButtons},{[`& .${nt.scrollButtons}`]:r.scrollButtonsHideMobile&&e.scrollButtonsHideMobile},e.root,r.vertical&&e.vertical]}})(({ownerState:t,theme:e})=>m({overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex"},t.vertical&&{flexDirection:"column"},t.scrollButtonsHideMobile&&{[`& .${nt.scrollButtons}`]:{[e.breakpoints.down("sm")]:{display:"none"}}})),Zo=J("div",{name:"MuiTabs",slot:"Scroller",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.scroller,r.fixed&&e.fixed,r.hideScrollbar&&e.hideScrollbar,r.scrollableX&&e.scrollableX,r.scrollableY&&e.scrollableY]}})(({ownerState:t})=>m({position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap"},t.fixed&&{overflowX:"hidden",width:"100%"},t.hideScrollbar&&{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},t.scrollableX&&{overflowX:"auto",overflowY:"hidden"},t.scrollableY&&{overflowY:"auto",overflowX:"hidden"})),en=J("div",{name:"MuiTabs",slot:"FlexContainer",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.flexContainer,r.vertical&&e.flexContainerVertical,r.centered&&e.centered]}})(({ownerState:t})=>m({display:"flex"},t.vertical&&{flexDirection:"column"},t.centered&&{justifyContent:"center"})),tn=J("span",{name:"MuiTabs",slot:"Indicator",overridesResolver:(t,e)=>e.indicator})(({ownerState:t,theme:e})=>m({position:"absolute",height:2,bottom:0,width:"100%",transition:e.transitions.create()},t.indicatorColor==="primary"&&{backgroundColor:(e.vars||e).palette.primary.main},t.indicatorColor==="secondary"&&{backgroundColor:(e.vars||e).palette.secondary.main},t.vertical&&{height:"100%",width:2,right:0})),on=J(No)({overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}),ht={},nn=a.forwardRef(function(e,r){const s=je({props:e,name:"MuiTabs"}),l=vt(),i=Ct(),{"aria-label":b,"aria-labelledby":p,action:d,centered:x=!1,children:y,className:w,component:B="div",allowScrollButtonsMobile:S=!1,indicatorColor:j="primary",onChange:h,orientation:v="horizontal",ScrollButtonComponent:g=Yo,scrollButtons:u="auto",selectionFollowsFocus:R,slots:N={},slotProps:Y={},TabIndicatorProps:K={},TabScrollButtonProps:I={},textColor:W="primary",value:O,variant:q="standard",visibleScrollbar:ue=!1}=s,$=xe(s,qo),H=q==="scrollable",k=v==="vertical",A=k?"scrollTop":"scrollLeft",ee=k?"top":"left",D=k?"bottom":"right",Q=k?"clientHeight":"clientWidth",V=k?"height":"width",pe=m({},s,{component:B,allowScrollButtonsMobile:S,indicatorColor:j,orientation:v,vertical:k,scrollButtons:u,textColor:W,variant:q,visibleScrollbar:ue,fixed:!H,hideScrollbar:H&&!ue,scrollableX:H&&!k,scrollableY:H&&k,centered:x&&!H,scrollButtonsHideMobile:!S}),ne=Qo(pe),G=Te({elementType:N.StartScrollButtonIcon,externalSlotProps:Y.startScrollButtonIcon,ownerState:pe}),Ke=Te({elementType:N.EndScrollButtonIcon,externalSlotProps:Y.endScrollButtonIcon,ownerState:pe}),[Me,qe]=a.useState(!1),[fe,Le]=a.useState(ht),[Ie,Qe]=a.useState(!1),[Pe,le]=a.useState(!1),[_e,Ae]=a.useState(!1),[We,Oe]=a.useState({overflow:"hidden",scrollbarWidth:0}),De=new Map,te=a.useRef(null),he=a.useRef(null),Fe=()=>{const c=te.current;let f;if(c){const E=c.getBoundingClientRect();f={clientWidth:c.clientWidth,scrollLeft:c.scrollLeft,scrollTop:c.scrollTop,scrollLeftNormalized:Zt(c,i?"rtl":"ltr"),scrollWidth:c.scrollWidth,top:E.top,bottom:E.bottom,left:E.left,right:E.right}}let z;if(c&&O!==!1){const E=he.current.children;if(E.length>0){const P=E[De.get(O)];z=P?P.getBoundingClientRect():null}}return{tabsMeta:f,tabMeta:z}},Ce=Re(()=>{const{tabsMeta:c,tabMeta:f}=Fe();let z=0,E;if(k)E="top",f&&c&&(z=f.top-c.top+c.scrollTop);else if(E=i?"right":"left",f&&c){const F=i?c.scrollLeftNormalized+c.clientWidth-c.scrollWidth:c.scrollLeft;z=(i?-1:1)*(f[E]-c[E]+F)}const P={[E]:z,[V]:f?f[V]:0};if(isNaN(fe[E])||isNaN(fe[V]))Le(P);else{const F=Math.abs(fe[E]-P[E]),ie=Math.abs(fe[V]-P[V]);(F>=1||ie>=1)&&Le(P)}}),be=(c,{animation:f=!0}={})=>{f?Oo(A,te.current,c,{duration:l.transitions.duration.standard}):te.current[A]=c},Ne=c=>{let f=te.current[A];k?f+=c:(f+=c*(i?-1:1),f*=i&&St()==="reverse"?-1:1),be(f)},n=()=>{const c=te.current[Q];let f=0;const z=Array.from(he.current.children);for(let E=0;E<z.length;E+=1){const P=z[E];if(f+P[Q]>c){E===0&&(f=c);break}f+=P[Q]}return f},C=()=>{Ne(-1*n())},T=()=>{Ne(n())},M=a.useCallback(c=>{Oe({overflow:null,scrollbarWidth:c})},[]),re=()=>{const c={};c.scrollbarSizeListener=H?o.jsx(on,{onChange:M,className:ae(ne.scrollableX,ne.hideScrollbar)}):null;const z=H&&(u==="auto"&&(Ie||Pe)||u===!0);return c.scrollButtonStart=z?o.jsx(g,m({slots:{StartScrollButtonIcon:N.StartScrollButtonIcon},slotProps:{startScrollButtonIcon:G},orientation:v,direction:i?"right":"left",onClick:C,disabled:!Ie},I,{className:ae(ne.scrollButtons,I.className)})):null,c.scrollButtonEnd=z?o.jsx(g,m({slots:{EndScrollButtonIcon:N.EndScrollButtonIcon},slotProps:{endScrollButtonIcon:Ke},orientation:v,direction:i?"left":"right",onClick:T,disabled:!Pe},I,{className:ae(ne.scrollButtons,I.className)})):null,c},oe=Re(c=>{const{tabsMeta:f,tabMeta:z}=Fe();if(!(!z||!f)){if(z[ee]<f[ee]){const E=f[A]+(z[ee]-f[ee]);be(E,{animation:c})}else if(z[D]>f[D]){const E=f[A]+(z[D]-f[D]);be(E,{animation:c})}}}),He=Re(()=>{H&&u!==!1&&Ae(!_e)});a.useEffect(()=>{const c=gt(()=>{te.current&&Ce()});let f;const z=F=>{F.forEach(ie=>{ie.removedNodes.forEach($e=>{var ge;(ge=f)==null||ge.unobserve($e)}),ie.addedNodes.forEach($e=>{var ge;(ge=f)==null||ge.observe($e)})}),c(),He()},E=yt(te.current);E.addEventListener("resize",c);let P;return typeof ResizeObserver<"u"&&(f=new ResizeObserver(c),Array.from(he.current.children).forEach(F=>{f.observe(F)})),typeof MutationObserver<"u"&&(P=new MutationObserver(z),P.observe(he.current,{childList:!0})),()=>{var F,ie;c.clear(),E.removeEventListener("resize",c),(F=P)==null||F.disconnect(),(ie=f)==null||ie.disconnect()}},[Ce,He]),a.useEffect(()=>{const c=Array.from(he.current.children),f=c.length;if(typeof IntersectionObserver<"u"&&f>0&&H&&u!==!1){const z=c[0],E=c[f-1],P={root:te.current,threshold:.99},F=Ze=>{Qe(!Ze[0].isIntersecting)},ie=new IntersectionObserver(F,P);ie.observe(z);const $e=Ze=>{le(!Ze[0].isIntersecting)},ge=new IntersectionObserver($e,P);return ge.observe(E),()=>{ie.disconnect(),ge.disconnect()}}},[H,u,_e,y==null?void 0:y.length]),a.useEffect(()=>{qe(!0)},[]),a.useEffect(()=>{Ce()}),a.useEffect(()=>{oe(ht!==fe)},[oe,fe]),a.useImperativeHandle(d,()=>({updateIndicator:Ce,updateScrollButtons:He}),[Ce,He]);const st=o.jsx(tn,m({},K,{className:ae(ne.indicator,K.className),ownerState:pe,style:m({},fe,K.style)}));let Ve=0;const wt=a.Children.map(y,c=>{if(!a.isValidElement(c))return null;const f=c.props.value===void 0?Ve:c.props.value;De.set(f,Ve);const z=f===O;return Ve+=1,a.cloneElement(c,m({fullWidth:q==="fullWidth",indicator:z&&!Me&&st,selected:z,selectionFollowsFocus:R,onChange:h,textColor:W,value:f},Ve===1&&O===!1&&!c.props.tabIndex?{tabIndex:0}:{}))}),kt=c=>{const f=he.current,z=Ye(f).activeElement;if(z.getAttribute("role")!=="tab")return;let P=v==="horizontal"?"ArrowLeft":"ArrowUp",F=v==="horizontal"?"ArrowRight":"ArrowDown";switch(v==="horizontal"&&i&&(P="ArrowRight",F="ArrowLeft"),c.key){case P:c.preventDefault(),Xe(f,z,ft);break;case F:c.preventDefault(),Xe(f,z,pt);break;case"Home":c.preventDefault(),Xe(f,null,pt);break;case"End":c.preventDefault(),Xe(f,null,ft);break}},Je=re();return o.jsxs(Jo,m({className:ae(ne.root,w),ownerState:pe,ref:r,as:B},$,{children:[Je.scrollButtonStart,Je.scrollbarSizeListener,o.jsxs(Zo,{className:ne.scroller,ownerState:pe,style:{overflow:We.overflow,[k?`margin${i?"Left":"Right"}`:"marginBottom"]:ue?void 0:-We.scrollbarWidth},ref:te,children:[o.jsx(en,{"aria-label":b,"aria-labelledby":p,"aria-orientation":v==="vertical"?"vertical":null,className:ne.flexContainer,ownerState:pe,onKeyDown:kt,ref:he,role:"tablist",children:wt}),Me&&st]}),Je.scrollButtonEnd]}))}),bt=Z(o.jsx("path",{d:"M21 3H3c-1.11 0-2 .89-2 2v12c0 1.1.89 2 2 2h5v2h8v-2h5c1.1 0 1.99-.9 1.99-2L23 5c0-1.11-.9-2-2-2m0 14H3V5h18zm-5-7v2h-3v3h-2v-3H8v-2h3V7h2v3z"}),"AddToQueue"),rn=Z(o.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel"),sn=Z(o.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle"),an=Z(o.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zm2.46-7.12 1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}),"DeleteForever"),ln=Z(o.jsx("path",{d:"M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"}),"GitHub"),cn=Z(o.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"RemoveRedEye"),dn=Z(o.jsx("path",{d:"M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2m4 0v12h4V3z"}),"ThumbDown"),un=Z(o.jsx("path",{d:"M1 21h4V9H1zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73z"}),"ThumbUp");async function de(t,e={}){var i,b;const{maxRetries:r=1,onRetry:s}=e;let l=null;for(let p=0;p<=r;p++)try{const d=await t();if(d.error&&((i=d.error.message)!=null&&i.includes("JWT")||(b=d.error.message)!=null&&b.includes("token")||d.error.code==="PGRST301"||d.error.code==="401")&&p<r){console.log("Auth error detected, refreshing session..."),s==null||s();const{error:x}=await se.auth.refreshSession();if(x){console.error("Failed to refresh session:",x),l=x;continue}await new Promise(y=>setTimeout(y,100));continue}return d}catch(d){l=d,p<r&&(console.log(`Operation failed, retrying (${p+1}/${r})...`),await new Promise(x=>setTimeout(x,100)))}return{data:null,error:l}}const xn=()=>{const t=It(),{isAdmin:e,loading:r,currentUser:s}=Pt(),[l,i]=a.useState([]),[b,p]=a.useState([]),[d,x]=a.useState(!0),[y,w]=a.useState(null),[B,S]=a.useState(null),[j,h]=a.useState(null),[v,g]=a.useState(!1),[u,R]=a.useState(null),[N,Y]=a.useState(!1),[K,I]=a.useState(""),[W,O]=a.useState(null),[q,ue]=a.useState(!1),[$,H]=a.useState("pending"),[k,A]=a.useState(new Set),[ee,D]=a.useState(!1),[Q,V]=a.useState(!1),[pe,ne]=a.useState(null);a.useEffect(()=>{const n=async()=>{if(!document.hidden&&s){console.log("Tab regained focus, checking session...");try{await ce(),v&&(g(!1),S(null),G($))}catch(C){console.error("Session refresh failed:",C),g(!0),S("Your session has expired. Please refresh the page to continue.")}}};return document.addEventListener("visibilitychange",n),window.addEventListener("focus",n),()=>{document.removeEventListener("visibilitychange",n),window.removeEventListener("focus",n)}},[s,$,v]);const G=a.useCallback(async n=>{var C;x(!0),S(null);try{await ce();const{data:T,error:M}=await de(async()=>await se.rpc("get_suggestions_with_user_email",{filter_status:n}),{onRetry:()=>S("Refreshing session...")});M?(console.error("Supabase RPC fetch error:",M),M.code==="42804"&&((C=M.details)!=null&&C.includes("character varying(255)"))?S("Database function error: Email column type mismatch. Ensure 'u.email::text' is used."):S(`Failed to fetch suggestions: ${M.message}`),i([])):i(T||[]);const{data:re,error:oe}=await de(async()=>await se.from("packages").select("id, package_name"));oe?console.error("Error fetching existing packages:",oe):p(re||[])}catch(T){console.error("Error in fetchSuggestions:",T),S(`An unexpected error occurred: ${T.message}`),i([])}finally{x(!1)}},[]);a.useEffect(()=>{!r&&e&&G($)},[r,e,$,G]);const Ke=async n=>{if(s){w(n),S(null);try{await ce();const{error:C}=await de(async()=>await se.from("package_suggestions").update({status:"approved",reviewed_at:new Date().toISOString(),reviewed_by_admin_id:s.id}).eq("id",n),{onRetry:()=>S("Session expired, refreshing...")});if(C)throw C;h("Suggestion approved successfully."),G($)}catch(C){le(C,"Failed to approve suggestion")}finally{w(null)}}},Me=async(n,C,T)=>{if(s){w(n);try{await ce();const{error:M}=await de(async()=>await se.from("package_suggestions").update({status:C,admin_notes:T,reviewed_at:new Date().toISOString(),reviewed_by_admin_id:s.id}).eq("id",n));if(M)throw M;h(`Suggestion status updated to ${C}.`),G($),Y(!1),R(null),I("")}catch(M){le(M,"Failed to update suggestion status")}finally{w(null)}}},qe=async n=>{if(s){w(n.id),S(null),h(null);try{await ce();const{error:C}=await de(async()=>await se.rpc("approve_suggestion_with_normalized_data",{suggestion_id:n.id,approved_by:s.id}));if(C)throw C;h("Package added successfully and suggestion marked as added."),G($)}catch(C){le(C,"Failed to add package")}finally{w(null)}}},fe=async(n,C)=>{if(window.confirm(`Are you sure you want to permanently delete the suggestion for "${C}"? This action cannot be undone.`)){w(n),S(null),h(null);try{await ce();const{error:T}=await de(async()=>await se.from("package_suggestions").delete().eq("id",n));if(T)throw T;h(`Suggestion "${C}" deleted successfully.`),G($)}catch(T){le(T,"Failed to delete suggestion")}finally{w(null)}}},Le=async()=>{if(k.size!==0&&window.confirm(`Are you sure you want to approve ${k.size} selected suggestion(s)?`)){V(!0),S(null);try{await ce();const{error:n}=await de(async()=>await se.from("package_suggestions").update({status:"approved",reviewed_at:new Date().toISOString(),reviewed_by_admin_id:s==null?void 0:s.id}).in("id",Array.from(k)));if(n)throw n;h(`${k.size} suggestion(s) approved successfully!`),A(new Set),D(!1),G($)}catch(n){le(n,"Failed to approve suggestions")}finally{V(!1)}}},Ie=async()=>{if(k.size!==0&&window.confirm(`Are you sure you want to reject ${k.size} selected suggestion(s)?`)){V(!0),S(null);try{await ce();const{error:n}=await de(async()=>await se.from("package_suggestions").update({status:"rejected",reviewed_at:new Date().toISOString(),reviewed_by_admin_id:s==null?void 0:s.id}).in("id",Array.from(k)));if(n)throw n;h(`${k.size} suggestion(s) rejected successfully!`),A(new Set),D(!1),G($)}catch(n){le(n,"Failed to reject suggestions")}finally{V(!1)}}},Qe=async()=>{if(k.size!==0&&window.confirm(`Are you sure you want to permanently delete ${k.size} selected suggestion(s)? This action cannot be undone.`)){V(!0),S(null);try{await ce();const{error:n}=await de(async()=>await se.from("package_suggestions").delete().in("id",Array.from(k)));if(n)throw n;h(`${k.size} suggestion(s) deleted successfully!`),A(new Set),D(!1),G($)}catch(n){le(n,"Failed to delete suggestions")}finally{V(!1)}}},Pe=async()=>{if(k.size!==0&&window.confirm(`Are you sure you want to add ${k.size} selected approved suggestion(s) to the database?`)){V(!0),S(null),h(null);try{await ce();const n=l.filter(re=>k.has(re.id));let C=0,T=0;const M=[];for(const re of n)try{const{error:oe}=await de(async()=>await se.rpc("approve_suggestion_with_normalized_data",{suggestion_id:re.id,approved_by:s==null?void 0:s.id}));oe?(console.error(`Error processing suggestion ${re.package_name}:`,oe),M.push(`Failed to add "${re.package_name}": ${oe.message}`),T++):C++}catch(oe){console.error(`Error processing suggestion ${re.package_name}:`,oe),M.push(`Failed to process "${re.package_name}": ${oe.message}`),T++}C>0&&T===0?h(`Successfully added ${C} package(s) to database and marked suggestions as 'Added'.`):C>0&&T>0?(h(`Added ${C} package(s) successfully. ${T} failed.`),S(`Some operations failed: ${M.slice(0,3).join("; ")}${M.length>3?"...":""}`)):S(`All operations failed: ${M.slice(0,3).join("; ")}${M.length>3?"...":""}`),A(new Set),D(!1),G($)}catch(n){le(n,"Failed to batch add packages")}finally{V(!1)}}},le=(n,C)=>{var T,M;console.error(C,n),(T=n.message)!=null&&T.includes("session")||(M=n.message)!=null&&M.includes("JWT")||n.code==="PGRST301"?(g(!0),S("Your session has expired. Please refresh the page and try again."),setTimeout(()=>{window.confirm("Your session has expired. Would you like to refresh the page?")&&window.location.reload()},2e3)):S(`${C}: ${n.message}`)},_e=n=>{R(n),I(n.admin_notes||""),Y(!0)},Ae=()=>{R(null),Y(!1),I("")},We=(n,C)=>{H(C),A(new Set),D(!1)},Oe=()=>{if(ee)A(new Set),D(!1);else{const n=new Set(l.map(C=>C.id));A(n),D(!0)}},De=n=>{const C=new Set(k);C.has(n)?C.delete(n):C.add(n),A(C),D(C.size===l.length)},te=n=>{O(n),ue(!0)},he=()=>{O(null),ue(!1)},Fe=()=>{G($),ue(!1),O(null),h("Suggestion updated successfully.")},Ce=n=>{switch(n){case"pending":return"warning";case"approved":return"success";case"rejected":return"error";case"added":return"info";default:return"default"}},be=n=>b.some(C=>C.package_name.toLowerCase()===n.toLowerCase()),Ne=n=>o.jsxs(me,{sx:{p:1},children:[o.jsx(U,{variant:"subtitle2",sx:{fontWeight:"bold",mb:1},children:n.package_name}),n.description&&o.jsx(U,{variant:"body2",sx:{mb:1},children:n.description}),o.jsxs(me,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[n.license&&o.jsxs(U,{variant:"caption",children:["License: ",n.license]}),n.tags&&n.tags.length>0&&o.jsxs(U,{variant:"caption",children:["Tags: ",n.tags.join(", ")]}),n.folder&&o.jsxs(U,{variant:"caption",children:["Folder: ",n.folder," ",n.category&&`> ${n.category}`]})]}),n.admin_notes&&o.jsxs(U,{variant:"caption",sx:{mt:1,fontStyle:"italic"},children:["Admin notes: ",n.admin_notes]})]});return r?o.jsx(me,{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh",children:o.jsx(Ee,{})}):e?o.jsxs(lt,{maxWidth:"xl",sx:{mt:4,mb:4},children:[o.jsx(U,{variant:"h4",gutterBottom:!0,component:"h1",sx:{mb:2,color:n=>(n.palette.mode==="dark",n.palette.text.primary)},children:"Review Package Suggestions"}),o.jsx(To,{open:!!j,autoHideDuration:6e3,onClose:()=>h(null),message:j}),v&&o.jsxs(et,{severity:"error",sx:{mb:2},children:["Your session has expired. Please refresh the page to continue working.",o.jsx(Se,{size:"small",onClick:()=>window.location.reload(),sx:{ml:2},children:"Refresh Now"})]}),o.jsx(me,{sx:{borderBottom:1,borderColor:"divider",mb:2},children:o.jsxs(nn,{value:$,onChange:We,"aria-label":"suggestion status filter",children:[o.jsx(Ue,{label:"Pending",value:"pending"}),o.jsx(Ue,{label:"Approved",value:"approved"}),o.jsx(Ue,{label:"Rejected",value:"rejected"}),o.jsx(Ue,{label:"Added to DB",value:"added"})]})}),d&&o.jsx(me,{display:"flex",justifyContent:"center",py:3,children:o.jsx(Ee,{})}),B&&!v&&o.jsx(et,{severity:"error",sx:{mb:2},children:B}),!d&&!B&&l.length===0&&o.jsxs(U,{sx:{mt:2},children:["No ",$," suggestions found."]}),!d&&!B&&l.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs(me,{sx:{mb:2,display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[o.jsx(_t,{control:o.jsx(ot,{checked:ee,indeterminate:k.size>0&&k.size<l.length,onChange:Oe,disabled:Q||v}),label:`Select All (${k.size}/${l.length})`}),k.size>0&&o.jsxs(so,{variant:"outlined",disabled:Q||v,children:[$==="pending"&&o.jsxs(o.Fragment,{children:[o.jsxs(Se,{color:"success",onClick:Le,startIcon:o.jsx(un,{}),disabled:Q,children:["Approve (",k.size,")"]}),o.jsxs(Se,{color:"error",onClick:Ie,startIcon:o.jsx(dn,{}),disabled:Q,children:["Reject (",k.size,")"]})]}),$==="approved"&&o.jsxs(Se,{color:"primary",onClick:Pe,startIcon:o.jsx(bt,{}),disabled:Q,children:["Add to Database (",k.size,")"]}),o.jsxs(Se,{color:"error",onClick:Qe,startIcon:o.jsx(an,{}),disabled:Q,children:["Delete (",k.size,")"]})]}),Q&&o.jsx(Ee,{size:20})]}),o.jsx(Ot,{component:mt,elevation:2,children:o.jsxs(Dt,{sx:{minWidth:800},"aria-label":"review suggestions table",children:[o.jsx(Ft,{children:o.jsxs(ct,{children:[o.jsx(X,{padding:"checkbox",children:o.jsx(ot,{checked:ee,indeterminate:k.size>0&&k.size<l.length,onChange:Oe,disabled:Q||v})}),o.jsx(X,{children:"Package Name"}),o.jsx(X,{children:"Description"}),o.jsx(X,{children:"Links"}),o.jsx(X,{children:"Suggested By"}),o.jsx(X,{children:"Status"}),o.jsx(X,{align:"center",children:"Actions"})]})}),o.jsx(Nt,{children:l.map(n=>o.jsxs(ct,{onMouseEnter:()=>ne(n.id),onMouseLeave:()=>ne(null),children:[o.jsx(X,{padding:"checkbox",children:o.jsx(ot,{checked:k.has(n.id),onChange:()=>De(n.id),disabled:Q||v})}),o.jsx(X,{children:o.jsxs(me,{children:[o.jsx(Ge,{title:Ne(n),open:pe===n.id,placement:"right",arrow:!0,children:o.jsx(At,{component:"button",variant:"body1",onClick:()=>te(n),sx:{fontWeight:"bold",textAlign:"left",cursor:"pointer","&:hover":{textDecoration:"underline"}},children:n.package_name})}),be(n.package_name)&&o.jsx(it,{label:"Duplicate",color:"error",size:"small",sx:{mt:.5,ml:1}}),n.license&&o.jsxs(U,{variant:"caption",color:"text.secondary",display:"block",children:["License: ",n.license]})]})}),o.jsx(X,{sx:{maxWidth:300},children:o.jsx(U,{variant:"body2",sx:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical"},children:n.description||"No description provided"})}),o.jsx(X,{children:o.jsxs(me,{sx:{display:"flex",gap:.5,alignItems:"center"},children:[n.repo_link&&o.jsx(Ge,{title:"GitHub Repository",children:o.jsx(ve,{size:"small",href:n.repo_link,target:"_blank",rel:"noopener noreferrer",sx:{p:.5},children:o.jsx(ln,{fontSize:"small"})})}),n.webserver&&o.jsx(Ge,{title:"Website",children:o.jsx(ve,{size:"small",href:n.webserver,target:"_blank",rel:"noopener noreferrer",sx:{p:.5},children:o.jsx(Gt,{fontSize:"small"})})}),n.publication&&o.jsx(Ge,{title:"Publication",children:o.jsx(ve,{size:"small",href:n.publication,target:"_blank",rel:"noopener noreferrer",sx:{p:.5},children:o.jsx(Ut,{fontSize:"small"})})}),!n.repo_link&&!n.webserver&&!n.publication&&o.jsx(U,{variant:"caption",color:"text.secondary",children:"No links provided"})]})}),o.jsxs(X,{children:[o.jsx(U,{variant:"caption",children:n.user_email||"Anonymous"}),o.jsx("br",{}),o.jsx(U,{variant:"caption",color:"text.secondary",children:new Date(n.created_at).toLocaleDateString()})]}),o.jsx(X,{children:o.jsx(it,{label:n.status,color:Ce(n.status),size:"small"})}),o.jsx(X,{align:"center",children:o.jsxs(me,{sx:{display:"flex",gap:.5,justifyContent:"center"},children:[n.status==="added"&&n.package_id&&o.jsx(ve,{size:"small",color:"info",onClick:()=>t(`/package/${encodeURIComponent(n.package_id)}`),title:"View Package",children:o.jsx(cn,{fontSize:"small"})}),o.jsx(ve,{size:"small",color:"primary",onClick:()=>te(n),disabled:y===n.id||v,title:"Edit Suggestion",children:o.jsx(Xt,{fontSize:"small"})}),n.status==="pending"&&o.jsx(ve,{size:"small",color:"success",onClick:()=>Ke(n.id),disabled:y===n.id||be(n.package_name)||v,title:be(n.package_name)?"Cannot approve duplicate package":"Approve",children:y===n.id?o.jsx(Ee,{size:20}):o.jsx(sn,{fontSize:"small"})}),n.status==="pending"&&o.jsx(ve,{size:"small",color:"error",onClick:()=>_e(n),disabled:y===n.id||v,title:"Reject",children:o.jsx(rn,{fontSize:"small"})}),n.status==="approved"&&o.jsx(ve,{size:"small",color:"primary",onClick:()=>qe(n),disabled:y===n.id||be(n.package_name)||v,title:be(n.package_name)?"Cannot add duplicate package":"Add to Database",children:y===n.id?o.jsx(Ee,{size:20}):o.jsx(bt,{fontSize:"small"})}),o.jsx(ve,{size:"small",color:"error",onClick:()=>fe(n.id,n.package_name),disabled:y===n.id||v,title:"Delete Suggestion",children:y===n.id?o.jsx(Ee,{size:20}):o.jsx(Yt,{fontSize:"small"})})]})})]},n.id))})]})})]}),o.jsxs(Kt,{open:N,onClose:Ae,maxWidth:"sm",fullWidth:!0,children:[o.jsx(qt,{children:"Reject Suggestion"}),o.jsxs(Qt,{children:[o.jsxs(U,{variant:"body2",sx:{mb:2},children:['Are you sure you want to reject the suggestion for "',u==null?void 0:u.package_name,'"?']}),o.jsx(Wt,{fullWidth:!0,multiline:!0,rows:3,label:"Admin Notes (Optional)",value:K,onChange:n=>I(n.target.value),placeholder:"Provide a reason for rejection..."})]}),o.jsxs(Jt,{children:[o.jsx(Se,{onClick:Ae,children:"Cancel"}),o.jsx(Se,{color:"error",variant:"contained",onClick:()=>{u&&Me(u.id,"rejected",K)},disabled:y===(u==null?void 0:u.id)||v,children:"Reject"})]})]}),W&&o.jsx(Ht,{open:q,suggestion:W,onClose:he,onSaveSuccess:Fe,isAdmin:e})]}):o.jsx(lt,{maxWidth:"md",sx:{mt:4},children:o.jsx(et,{severity:"error",children:"Access Denied. Admins only."})})};export{xn as default};
