import{r as c,g as $,a as H,d as S,_ as N,b as v,j as l,s as E,f as U,i as D,h as z,k as w,x as le,y as re,z as se,D as ne,n as B,A as I,Z as T,$ as ie,K as de,F as O,a1 as G,S as J,M as F,G as K,q as ce,t as ue}from"./index-DJGmrbOz.js";import{D as pe,a as be,b as ve,c as ge}from"./DialogTitle-Cn6Bmbi-.js";import{G as f}from"./Grid-B0LgO5dT.js";const ae=c.createContext();function me(e){return $("MuiTable",e)}H("MuiTable",["root","stickyHeader"]);const fe=["className","component","padding","size","stickyHeader"],xe=e=>{const{classes:t,stickyHeader:a}=e;return D({root:["root",a&&"stickyHeader"]},me,t)},he=E("table",{name:"MuiTable",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,a.stickyHeader&&t.stickyHeader]}})(({theme:e,ownerState:t})=>v({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":v({},e.typography.body2,{padding:e.spacing(2),color:(e.vars||e).palette.text.secondary,textAlign:"left",captionSide:"bottom"})},t.stickyHeader&&{borderCollapse:"separate"})),V="table",Ke=c.forwardRef(function(t,a){const r=S({props:t,name:"MuiTable"}),{className:i,component:o=V,padding:n="normal",size:d="medium",stickyHeader:u=!1}=r,C=N(r,fe),b=v({},r,{component:o,padding:n,size:d,stickyHeader:u}),_=xe(b),R=c.useMemo(()=>({padding:n,size:d,stickyHeader:u}),[n,d,u]);return l.jsx(ae.Provider,{value:R,children:l.jsx(he,v({as:o,role:o===V?null:"table",ref:a,className:U(_.root,i),ownerState:b},C))})}),L=c.createContext();function ye(e){return $("MuiTableBody",e)}H("MuiTableBody",["root"]);const Ce=["className","component"],je=e=>{const{classes:t}=e;return D({root:["root"]},ye,t)},Te=E("tbody",{name:"MuiTableBody",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"table-row-group"}),_e={variant:"body"},X="tbody",Ve=c.forwardRef(function(t,a){const r=S({props:t,name:"MuiTableBody"}),{className:i,component:o=X}=r,n=N(r,Ce),d=v({},r,{component:o}),u=je(d);return l.jsx(L.Provider,{value:_e,children:l.jsx(Te,v({className:U(u.root,i),as:o,ref:a,role:o===X?null:"rowgroup",ownerState:d},n))})});function Re(e){return $("MuiTableCell",e)}const ke=H("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),Me=["align","className","component","padding","scope","size","sortDirection","variant"],we=e=>{const{classes:t,variant:a,align:r,padding:i,size:o,stickyHeader:n}=e,d={root:["root",a,n&&"stickyHeader",r!=="inherit"&&`align${z(r)}`,i!=="normal"&&`padding${z(i)}`,`size${z(o)}`]};return D(d,Re,t)},ze=E("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,t[a.variant],t[`size${z(a.size)}`],a.padding!=="normal"&&t[`padding${z(a.padding)}`],a.align!=="inherit"&&t[`align${z(a.align)}`],a.stickyHeader&&t.stickyHeader]}})(({theme:e,ownerState:t})=>v({},e.typography.body2,{display:"table-cell",verticalAlign:"inherit",borderBottom:e.vars?`1px solid ${e.vars.palette.TableCell.border}`:`1px solid
    ${e.palette.mode==="light"?w.lighten(w.alpha(e.palette.divider,1),.88):w.darken(w.alpha(e.palette.divider,1),.68)}`,textAlign:"left",padding:16},t.variant==="head"&&{color:(e.vars||e).palette.text.primary,lineHeight:e.typography.pxToRem(24),fontWeight:e.typography.fontWeightMedium},t.variant==="body"&&{color:(e.vars||e).palette.text.primary},t.variant==="footer"&&{color:(e.vars||e).palette.text.secondary,lineHeight:e.typography.pxToRem(21),fontSize:e.typography.pxToRem(12)},t.size==="small"&&{padding:"6px 16px",[`&.${ke.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}},t.padding==="checkbox"&&{width:48,padding:"0 0 0 4px"},t.padding==="none"&&{padding:0},t.align==="left"&&{textAlign:"left"},t.align==="center"&&{textAlign:"center"},t.align==="right"&&{textAlign:"right",flexDirection:"row-reverse"},t.align==="justify"&&{textAlign:"justify"},t.stickyHeader&&{position:"sticky",top:0,zIndex:2,backgroundColor:(e.vars||e).palette.background.default})),Xe=c.forwardRef(function(t,a){const r=S({props:t,name:"MuiTableCell"}),{align:i="inherit",className:o,component:n,padding:d,scope:u,size:C,sortDirection:b,variant:_}=r,R=N(r,Me),j=c.useContext(ae),M=c.useContext(L),x=M&&M.variant==="head";let k;n?k=n:k=x?"th":"td";let h=u;k==="td"?h=void 0:!h&&x&&(h="col");const y=_||M&&M.variant,P=v({},r,{align:i,component:k,padding:d||(j&&j.padding?j.padding:"normal"),size:C||(j&&j.size?j.size:"medium"),sortDirection:b,stickyHeader:y==="head"&&j&&j.stickyHeader,variant:y}),A=we(P);let q=null;return b&&(q=b==="asc"?"ascending":"descending"),l.jsx(ze,v({as:k,ref:a,className:U(A.root,o),"aria-sort":q,scope:h,ownerState:P},R))});function $e(e){return $("MuiTableContainer",e)}H("MuiTableContainer",["root"]);const He=["className","component"],Se=e=>{const{classes:t}=e;return D({root:["root"]},$e,t)},Ne=E("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(e,t)=>t.root})({width:"100%",overflowX:"auto"}),Ze=c.forwardRef(function(t,a){const r=S({props:t,name:"MuiTableContainer"}),{className:i,component:o="div"}=r,n=N(r,He),d=v({},r,{component:o}),u=Se(d);return l.jsx(Ne,v({ref:a,as:o,className:U(u.root,i),ownerState:d},n))});function Ee(e){return $("MuiTableHead",e)}H("MuiTableHead",["root"]);const Ue=["className","component"],De=e=>{const{classes:t}=e;return D({root:["root"]},Ee,t)},We=E("thead",{name:"MuiTableHead",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"table-header-group"}),Pe={variant:"head"},Z="thead",Qe=c.forwardRef(function(t,a){const r=S({props:t,name:"MuiTableHead"}),{className:i,component:o=Z}=r,n=N(r,Ue),d=v({},r,{component:o}),u=De(d);return l.jsx(L.Provider,{value:Pe,children:l.jsx(We,v({as:o,className:U(u.root,i),ref:a,role:o===Z?null:"rowgroup",ownerState:d},n))})});function Ae(e){return $("MuiTableRow",e)}const Q=H("MuiTableRow",["root","selected","hover","head","footer"]),qe=["className","component","hover","selected"],Fe=e=>{const{classes:t,selected:a,hover:r,head:i,footer:o}=e;return D({root:["root",a&&"selected",r&&"hover",i&&"head",o&&"footer"]},Ae,t)},Le=E("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,a.head&&t.head,a.footer&&t.footer]}})(({theme:e})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${Q.hover}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${Q.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:w.alpha(e.palette.primary.main,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:w.alpha(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity)}}})),Y="tr",Ye=c.forwardRef(function(t,a){const r=S({props:t,name:"MuiTableRow"}),{className:i,component:o=Y,hover:n=!1,selected:d=!1}=r,u=N(r,qe),C=c.useContext(L),b=v({},r,{component:o,hover:n,selected:d,head:C&&C.variant==="head",footer:C&&C.variant==="footer"}),_=Fe(b);return l.jsx(Le,v({as:o,ref:a,className:U(_.root,i),role:o===Y?null:"row",ownerState:b},u))});var W={},ee;function Be(){if(ee)return W;ee=1;var e=le();Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var t=e(re()),a=se();return W.default=(0,t.default)((0,a.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit"),W}var Ie=Be();const ea=ne(Ie),aa=({open:e,onClose:t,suggestion:a,onSaveSuccess:r,isAdmin:i})=>{const[o,n]=c.useState({}),[d,u]=c.useState(!1),[C,b]=c.useState(null),[_,R]=c.useState(null),j=B(s=>s.allAvailableTags),M=B(s=>s.allAvailableFolders),x=B(s=>s.allAvailableCategories),[k,h]=c.useState([]);c.useEffect(()=>{a?(n({package_name:a.package_name||"",description:a.description||"",publication_url:a.publication_url||"",webserver_url:a.webserver_url||"",repo_url:a.repo_url||"",link_url:a.link_url||"",license:a.license||"",tags:a.tags||[],folder1:a.folder1||"",category1:a.category1||"",suggestion_reason:a.suggestion_reason||"",admin_notes:i?a.admin_notes||"":void 0}),a.folder1&&x[a.folder1]?h(x[a.folder1]):h([])):(n({}),h([])),b(null),R(null)},[a,i,e,x]),c.useEffect(()=>{var s;o.folder1&&x[o.folder1]?h(x[o.folder1]):h([]),o.folder1&&!((s=x[o.folder1])!=null&&s.includes(o.category1||""))&&n(g=>({...g,category1:""}))},[o.folder1,x,o.category1]);const y=s=>{const{name:g,value:m}=s.target;n(p=>({...p,[g]:m})),g==="folder1"&&n(p=>({...p,category1:""}))},P=(s,g)=>{n(m=>({...m,tags:g}))},A=(s,g)=>{const{value:m}=s.target;n(p=>({...p,[g]:m})),g==="folder1"&&(n(p=>({...p,category1:""})),m&&x[m]?h(x[m]):h([]))},q=async s=>{var m;if(s.preventDefault(),!a){b("No suggestion selected for editing.");return}if(!((m=o.package_name)!=null&&m.trim())){b("Package name is required.");return}u(!0),b(null),R(null);const g={package_name:o.package_name,description:o.description||void 0,publication_url:o.publication_url||void 0,webserver_url:o.webserver_url||void 0,repo_url:o.repo_url||void 0,link_url:o.link_url||void 0,license:o.license||void 0,tags:o.tags&&o.tags.length>0?o.tags:void 0,folder1:o.folder1||void 0,category1:o.category1||void 0,suggestion_reason:o.suggestion_reason||void 0};i&&(g.admin_notes=o.admin_notes||void 0);try{const{error:p}=await ue.from("package_suggestions").update(g).eq("id",a.id);if(p)throw console.error("Supabase update error:",p),p;R("Suggestion updated successfully!"),u(!1),r()}catch(p){console.error("Error in handleSubmit:",p),b(p.message||"Failed to update suggestion."),u(!1)}};return a?l.jsxs(pe,{open:e,onClose:t,maxWidth:"md",fullWidth:!0,scroll:"paper",children:[l.jsxs(be,{children:["Edit Suggestion: ",a.package_name]}),l.jsxs("form",{onSubmit:q,children:[l.jsxs(ve,{dividers:!0,children:[C&&l.jsx(I,{severity:"error",sx:{mb:2},children:C}),_&&l.jsx(I,{severity:"success",sx:{mb:2},children:_}),l.jsxs(f,{container:!0,spacing:2,sx:{mt:.5},children:[l.jsx(f,{item:!0,xs:12,sm:6,children:l.jsx(T,{label:"Package Name",name:"package_name",value:o.package_name||"",onChange:y,fullWidth:!0,required:!0,variant:"outlined",size:"small"})}),l.jsx(f,{item:!0,xs:12,sm:6,children:l.jsx(T,{label:"License",name:"license",value:o.license||"",onChange:y,fullWidth:!0,variant:"outlined",size:"small"})}),l.jsx(f,{item:!0,xs:12,children:l.jsx(T,{label:"Description",name:"description",value:o.description||"",onChange:y,multiline:!0,rows:3,fullWidth:!0,variant:"outlined"})}),l.jsx(f,{item:!0,xs:12,sm:6,children:l.jsx(T,{label:"Publication URL",name:"publication_url",type:"url",value:o.publication_url||"",onChange:y,fullWidth:!0,variant:"outlined",size:"small"})}),l.jsx(f,{item:!0,xs:12,sm:6,children:l.jsx(T,{label:"Webserver URL",name:"webserver_url",type:"url",value:o.webserver_url||"",onChange:y,fullWidth:!0,variant:"outlined",size:"small"})}),l.jsx(f,{item:!0,xs:12,sm:6,children:l.jsx(T,{label:"Repository URL",name:"repo_url",type:"url",value:o.repo_url||"",onChange:y,fullWidth:!0,variant:"outlined",size:"small"})}),l.jsx(f,{item:!0,xs:12,sm:6,children:l.jsx(T,{label:"Other Link URL",name:"link_url",type:"url",value:o.link_url||"",onChange:y,fullWidth:!0,variant:"outlined",size:"small"})}),l.jsx(f,{item:!0,xs:12,children:l.jsx(ie,{multiple:!0,id:"tags-edit-suggestion",options:j,value:o.tags||[],onChange:P,freeSolo:!0,renderTags:(s,g)=>s.map((m,p)=>{const{key:te,...oe}=g({index:p});return l.jsx(de,{variant:"outlined",label:m,...oe,size:"small"},te)}),renderInput:s=>l.jsx(T,{...s,variant:"outlined",label:"Tags",placeholder:"Add or select tags",size:"small"})})}),l.jsx(f,{item:!0,xs:12,sm:6,children:l.jsxs(O,{fullWidth:!0,variant:"outlined",size:"small",children:[l.jsx(G,{id:"folder1-edit-label",children:"Folder"}),l.jsxs(J,{labelId:"folder1-edit-label",id:"folder1-edit",name:"folder1",value:o.folder1||"",onChange:s=>A(s,"folder1"),label:"Folder",children:[l.jsx(F,{value:"",children:l.jsx("em",{children:"None"})}),M.map(s=>l.jsx(F,{value:s,children:s},s))]})]})}),l.jsx(f,{item:!0,xs:12,sm:6,children:l.jsxs(O,{fullWidth:!0,variant:"outlined",size:"small",disabled:!o.folder1,children:[l.jsx(G,{id:"category1-edit-label",children:"Category"}),l.jsxs(J,{labelId:"category1-edit-label",id:"category1-edit",name:"category1",value:o.category1||"",onChange:s=>A(s,"category1"),label:"Category",children:[l.jsx(F,{value:"",children:l.jsx("em",{children:"None"})}),k.map(s=>l.jsx(F,{value:s,children:s},s))]})]})}),l.jsx(f,{item:!0,xs:12,children:l.jsx(T,{label:"Reason for Suggestion",name:"suggestion_reason",value:o.suggestion_reason||"",onChange:y,multiline:!0,rows:3,fullWidth:!0,variant:"outlined",disabled:!i&&(a==null?void 0:a.status)!=="pending"})}),i&&l.jsx(f,{item:!0,xs:12,children:l.jsx(T,{label:"Admin Notes",name:"admin_notes",value:o.admin_notes||"",onChange:y,multiline:!0,rows:3,fullWidth:!0,variant:"outlined"})})]})]}),l.jsxs(ge,{sx:{p:"16px 24px"},children:[l.jsx(K,{onClick:t,color:"inherit",children:"Cancel"}),l.jsx(K,{type:"submit",variant:"contained",color:"primary",disabled:d||(a==null?void 0:a.status)!=="pending"&&!i,children:d?l.jsx(ce,{size:24,color:"inherit"}):"Save Changes"})]})]})]}):null};export{ea as E,Ze as T,Ke as a,Qe as b,Ye as c,Xe as d,Ve as e,aa as f};
