import{Q as M,R as U,r as i,n as k,j as e,p as B,q as C,C as G,U as q,T as z,G as s,a3 as o,F as S,a6 as w,S as T,M as h,a4 as H,N as O,A as W,H as Y,t as K}from"./index-B9BmRKEw.js";const $=()=>{const P=M(),{currentUser:c,loading:p}=U(),[t,d]=i.useState({package_name:"",description:"",publication_url:"",webserver_url:"",repo_url:"",link_url:"",license:"",tags:[],folder1:"",category1:"",suggestion_reason:""}),[x,b]=i.useState(!1),[v,g]=i.useState(null),[f,j]=i.useState(null),A=k(a=>a.allAvailableTags),m=k(a=>a.originalPackages),[F,I]=i.useState([]),[L,y]=i.useState([]);i.useEffect(()=>{g(!p&&!c?"You must be logged in to suggest a package.":null)},[c,p,P]),i.useEffect(()=>{const a=[...new Set(m.map(r=>r.folder1).filter(Boolean))].sort();I(a)},[m]),i.useEffect(()=>{if(t.folder1){const a=[...new Set(m.filter(r=>r.folder1===t.folder1&&r.category1).map(r=>r.category1))].sort();y(a)}else y([])},[t.folder1,m]);const u=a=>{const{name:r,value:l}=a.target;d(n=>({...n,[r]:l})),r==="folder1"&&d(n=>({...n,category1:""}))},_=a=>{const{name:r,value:l}=a.target;d(n=>({...n,[r]:l})),r==="folder1"&&d(n=>({...n,category1:""}))},R=(a,r)=>{d(l=>({...l,tags:r}))},E=async a=>{if(a.preventDefault(),g(null),j(null),!c){g("You must be logged in to suggest a package.");return}if(!t.package_name){g("Package Name is required.");return}b(!0);try{const r={suggested_by_user_id:c.id,package_name:t.package_name||"",description:t.description||void 0,publication_url:t.publication_url||void 0,webserver_url:t.webserver_url||void 0,repo_url:t.repo_url||void 0,link_url:t.link_url||void 0,license:t.license||void 0,tags:t.tags||[],folder1:t.folder1||void 0,category1:t.category1||void 0,suggestion_reason:t.suggestion_reason||void 0},{error:l}=await K.from("package_suggestions").insert([r]);if(l)throw l;j("Package suggestion submitted successfully! It will be reviewed by an admin."),d({package_name:"",description:"",publication_url:"",webserver_url:"",repo_url:"",link_url:"",license:"",tags:[],folder1:"",category1:"",suggestion_reason:""})}catch(r){console.error("Error submitting package suggestion: ",r.message),g(`Failed to submit suggestion: ${r.message}`)}finally{b(!1)}};return p?e.jsx(B,{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh",children:e.jsx(C,{})}):e.jsx(G,{maxWidth:"md",children:e.jsxs(q,{elevation:3,sx:{p:{xs:2,md:4},mt:4,mb:4,background:a=>a.palette.mode==="dark"?"linear-gradient(135deg, rgba(30,30,30,0.8) 0%, rgba(23,23,23,0.8) 100%)":"linear-gradient(135deg, rgba(255,255,255,0.8) 0%, rgba(249,250,251,0.8) 100%)",backdropFilter:"blur(8px)",border:0,overflow:"hidden",borderRadius:2},children:[e.jsx(z,{variant:"h4",gutterBottom:!0,component:"h1",sx:{textAlign:"center",mb:3,color:a=>(a.palette.mode==="dark",a.palette.text.primary)},children:"Suggest a New Package"}),e.jsx("form",{onSubmit:E,children:e.jsxs(s,{container:!0,spacing:3,children:[e.jsx(s,{item:!0,xs:12,children:e.jsx(o,{label:"Package Name",name:"package_name",value:t.package_name,onChange:u,required:!0,fullWidth:!0,variant:"outlined",helperText:"The primary name of the software or tool."})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(o,{label:"Description",name:"description",value:t.description,onChange:u,multiline:!0,rows:3,fullWidth:!0,variant:"outlined",helperText:"A brief summary of what the package does."})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(o,{label:"Publication URL (e.g., DOI link)",name:"publication_url",value:t.publication_url,onChange:u,fullWidth:!0,variant:"outlined",type:"url"})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(o,{label:"Webserver/Homepage URL",name:"webserver_url",value:t.webserver_url,onChange:u,fullWidth:!0,variant:"outlined",type:"url"})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(o,{label:"Code Repository URL (e.g., GitHub)",name:"repo_url",value:t.repo_url,onChange:u,fullWidth:!0,variant:"outlined",type:"url"})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(o,{label:"Other Relevant Link",name:"link_url",value:t.link_url,onChange:u,fullWidth:!0,variant:"outlined",type:"url"})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(o,{label:"License (e.g., MIT, GPL-3.0)",name:"license",value:t.license,onChange:u,fullWidth:!0,variant:"outlined"})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsxs(S,{fullWidth:!0,variant:"outlined",children:[e.jsx(w,{id:"folder1-label",children:"Folder"}),e.jsxs(T,{labelId:"folder1-label",id:"folder1",name:"folder1",value:t.folder1||"",onChange:_,label:"Folder",children:[e.jsx(h,{value:"",children:e.jsx("em",{children:"None"})}),F.map(a=>e.jsx(h,{value:a,children:a},a))]})]})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsxs(S,{fullWidth:!0,variant:"outlined",disabled:!t.folder1,children:[e.jsx(w,{id:"category1-label",children:"Category"}),e.jsxs(T,{labelId:"category1-label",id:"category1",name:"category1",value:t.category1||"",onChange:_,label:"Category",children:[e.jsx(h,{value:"",children:e.jsx("em",{children:"None"})}),L.map(a=>e.jsx(h,{value:a,children:a},a))]})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(H,{multiple:!0,id:"tags-suggest",options:A,value:t.tags||[],onChange:R,freeSolo:!0,renderTags:(a,r)=>a.map((l,n)=>{const{key:N,...D}=r({index:n});return e.jsx(O,{variant:"outlined",label:l,...D},N)}),renderInput:a=>e.jsx(o,{...a,variant:"outlined",label:"Tags",placeholder:"Add or select tags",helperText:"Keywords to help categorize the package."})})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(o,{label:"Reason for Suggestion (Optional)",name:"suggestion_reason",value:t.suggestion_reason,onChange:u,multiline:!0,rows:3,fullWidth:!0,variant:"outlined",helperText:"Why do you think this package should be added?"})}),e.jsxs(s,{item:!0,xs:12,children:[v&&e.jsx(W,{severity:"error",sx:{mb:2},children:v}),f&&e.jsx(W,{severity:"success",sx:{mb:2},children:f}),e.jsx(Y,{type:"submit",variant:"contained",color:"primary",disabled:x||!c,startIcon:x?e.jsx(C,{size:20}):null,fullWidth:!0,size:"large",children:x?"Submitting...":"Submit Suggestion"})]})]})})]})})};export{$ as default};
