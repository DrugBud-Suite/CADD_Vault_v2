import{Q as D,n as M,r as n,o as x,j as e,q as G,t as k,C as U,R as q,T as z,G as l,$ as o,F as C,a0 as S,S as w,M as h,a1 as B,N as H,A as T,H as O,Z as Y}from"./index-Cp6bVkxx.js";const K=()=>{const W=D(),{currentUser:c,loading:m}=M(),[t,d]=n.useState({package_name:"",description:"",publication_url:"",webserver_url:"",repo_url:"",link_url:"",license:"",tags:[],folder1:"",category1:"",suggestion_reason:""}),[p,b]=n.useState(!1),[v,g]=n.useState(null),[f,j]=n.useState(null),A=x(a=>a.allAvailableTags),[F,P]=n.useState([]),[I,_]=n.useState([]);n.useEffect(()=>{g(!m&&!c?"You must be logged in to suggest a package.":null)},[c,m,W]),n.useEffect(()=>{const a=x.getState().allAvailableFolders;P(a)},[]),n.useEffect(()=>{if(t.folder1){const a=x.getState().allAvailableCategories[t.folder1]||[];_(a)}else _([])},[t.folder1]);const u=a=>{const{name:r,value:s}=a.target;d(i=>({...i,[r]:s})),r==="folder1"&&d(i=>({...i,category1:""}))},y=a=>{const{name:r,value:s}=a.target;d(i=>({...i,[r]:s})),r==="folder1"&&d(i=>({...i,category1:""}))},L=(a,r)=>{d(s=>({...s,tags:r}))},R=async a=>{if(a.preventDefault(),g(null),j(null),!c){g("You must be logged in to suggest a package.");return}if(!t.package_name){g("Package Name is required.");return}b(!0);try{const r={suggested_by_user_id:c.id,package_name:t.package_name||"",description:t.description||void 0,publication_url:t.publication_url||void 0,webserver_url:t.webserver_url||void 0,repo_url:t.repo_url||void 0,link_url:t.link_url||void 0,license:t.license||void 0,tags:t.tags||[],folder1:t.folder1||void 0,category1:t.category1||void 0,suggestion_reason:t.suggestion_reason||void 0},{error:s}=await Y.from("package_suggestions").insert([r]);if(s)throw s;j("Package suggestion submitted successfully! It will be reviewed by an admin."),d({package_name:"",description:"",publication_url:"",webserver_url:"",repo_url:"",link_url:"",license:"",tags:[],folder1:"",category1:"",suggestion_reason:""})}catch(r){console.error("Error submitting package suggestion: ",r.message),g(`Failed to submit suggestion: ${r.message}`)}finally{b(!1)}};return m?e.jsx(G,{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh",children:e.jsx(k,{})}):e.jsx(U,{maxWidth:"md",children:e.jsxs(q,{elevation:3,sx:{p:{xs:2,md:4},mt:4,mb:4,background:a=>a.palette.mode==="dark"?"linear-gradient(135deg, rgba(30,30,30,0.8) 0%, rgba(23,23,23,0.8) 100%)":"linear-gradient(135deg, rgba(255,255,255,0.8) 0%, rgba(249,250,251,0.8) 100%)",backdropFilter:"blur(8px)",border:0,overflow:"hidden",borderRadius:2},children:[e.jsx(z,{variant:"h4",gutterBottom:!0,component:"h1",sx:{textAlign:"center",mb:3,color:a=>(a.palette.mode==="dark",a.palette.text.primary)},children:"Suggest a New Package"}),e.jsx("form",{onSubmit:R,children:e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{item:!0,xs:12,children:e.jsx(o,{label:"Package Name",name:"package_name",value:t.package_name,onChange:u,required:!0,fullWidth:!0,variant:"outlined",helperText:"The primary name of the software or tool."})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(o,{label:"Description",name:"description",value:t.description,onChange:u,multiline:!0,rows:3,fullWidth:!0,variant:"outlined",helperText:"A brief summary of what the package does."})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(o,{label:"Publication URL (e.g., DOI link)",name:"publication_url",value:t.publication_url,onChange:u,fullWidth:!0,variant:"outlined",type:"url"})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(o,{label:"Webserver/Homepage URL",name:"webserver_url",value:t.webserver_url,onChange:u,fullWidth:!0,variant:"outlined",type:"url"})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(o,{label:"Code Repository URL (e.g., GitHub)",name:"repo_url",value:t.repo_url,onChange:u,fullWidth:!0,variant:"outlined",type:"url"})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(o,{label:"Other Relevant Link",name:"link_url",value:t.link_url,onChange:u,fullWidth:!0,variant:"outlined",type:"url"})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(o,{label:"License (e.g., MIT, GPL-3.0)",name:"license",value:t.license,onChange:u,fullWidth:!0,variant:"outlined"})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsxs(C,{fullWidth:!0,variant:"outlined",children:[e.jsx(S,{id:"folder1-label",children:"Folder"}),e.jsxs(w,{labelId:"folder1-label",id:"folder1",name:"folder1",value:t.folder1||"",onChange:y,label:"Folder",children:[e.jsx(h,{value:"",children:e.jsx("em",{children:"None"})}),F.map(a=>e.jsx(h,{value:a,children:a},a))]})]})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsxs(C,{fullWidth:!0,variant:"outlined",disabled:!t.folder1,children:[e.jsx(S,{id:"category1-label",children:"Category"}),e.jsxs(w,{labelId:"category1-label",id:"category1",name:"category1",value:t.category1||"",onChange:y,label:"Category",children:[e.jsx(h,{value:"",children:e.jsx("em",{children:"None"})}),I.map(a=>e.jsx(h,{value:a,children:a},a))]})]})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(B,{multiple:!0,id:"tags-suggest",options:A,value:t.tags||[],onChange:L,freeSolo:!0,renderTags:(a,r)=>a.map((s,i)=>{const{key:E,...N}=r({index:i});return e.jsx(H,{variant:"outlined",label:s,...N},E)}),renderInput:a=>e.jsx(o,{...a,variant:"outlined",label:"Tags",placeholder:"Add or select tags",helperText:"Keywords to help categorize the package."})})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(o,{label:"Reason for Suggestion (Optional)",name:"suggestion_reason",value:t.suggestion_reason,onChange:u,multiline:!0,rows:3,fullWidth:!0,variant:"outlined",helperText:"Why do you think this package should be added?"})}),e.jsxs(l,{item:!0,xs:12,children:[v&&e.jsx(T,{severity:"error",sx:{mb:2},children:v}),f&&e.jsx(T,{severity:"success",sx:{mb:2},children:f}),e.jsx(O,{type:"submit",variant:"contained",color:"primary",disabled:p||!c,startIcon:p?e.jsx(k,{size:20}):null,fullWidth:!0,size:"large",children:p?"Submitting...":"Submit Suggestion"})]})]})})]})})};export{K as default};
