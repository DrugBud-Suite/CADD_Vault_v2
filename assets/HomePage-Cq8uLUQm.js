const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PackageCard-C6xU-Svd.js","assets/index-QxSUAMeM.js","assets/index-B7rZpWz0.css","assets/RatingInput-iaMSEsPG.js","assets/Delete-c6H5VuXS.js","assets/queryKeys-D4izN8f8.js","assets/PackageMetrics-C2XL-l2t.js","assets/Language-D-B4rR1C.js","assets/CardContent-B5HL5NL6.js","assets/PackageList-BUGHdAoU.js","assets/getValidReactChildren-CO-yNIWJ.js"])))=>i.map(i=>d[i]);
import{g as he,a as ge,r as C,_ as J,b as Re,c as A,u as fe,j as c,s as me,d as pe,e as G,f as xe,B as Ie,h as H,i as ie,k as Be,l as Pe,m as U,n as R,o as Te,p as je,q,t as T,v as Ee,w as X,x as ne,R as Oe,C as $e,A as Ae,T as O,y as Y,F as We,S as Fe,M as L,I as Le,z as ve}from"./index-QxSUAMeM.js";import{Q as De,u as Ne,q as be,a as Ve}from"./queryKeys-D4izN8f8.js";import{g as He}from"./getValidReactChildren-CO-yNIWJ.js";function qe(t){return ge("MuiToggleButton",t)}const N=he("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),ye=C.createContext({}),we=C.createContext(void 0);function Ge(t,n){return n===void 0||t===void 0?!1:Array.isArray(n)?n.indexOf(t)>=0:t===n}const Ue=["value"],Qe=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],Ke=t=>{const{classes:n,fullWidth:e,selected:s,disabled:i,size:o,color:r}=t,a={root:["root",s&&"selected",i&&"disabled",e&&"fullWidth",`size${G(o)}`,r]};return xe(a,qe,n)},Xe=me(Ie,{name:"MuiToggleButton",slot:"Root",overridesResolver:(t,n)=>{const{ownerState:e}=t;return[n.root,n[`size${G(e.size)}`]]}})(({theme:t,ownerState:n})=>{let e=n.color==="standard"?t.palette.text.primary:t.palette[n.color].main,s;return t.vars&&(e=n.color==="standard"?t.vars.palette.text.primary:t.vars.palette[n.color].main,s=n.color==="standard"?t.vars.palette.text.primaryChannel:t.vars.palette[n.color].mainChannel),A({},t.typography.button,{borderRadius:(t.vars||t).shape.borderRadius,padding:11,border:`1px solid ${(t.vars||t).palette.divider}`,color:(t.vars||t).palette.action.active},n.fullWidth&&{width:"100%"},{[`&.${N.disabled}`]:{color:(t.vars||t).palette.action.disabled,border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:H(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${N.selected}`]:{color:e,backgroundColor:t.vars?`rgba(${s} / ${t.vars.palette.action.selectedOpacity})`:H(e,t.palette.action.selectedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${s} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:H(e,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${s} / ${t.vars.palette.action.selectedOpacity})`:H(e,t.palette.action.selectedOpacity)}}}},n.size==="small"&&{padding:7,fontSize:t.typography.pxToRem(13)},n.size==="large"&&{padding:15,fontSize:t.typography.pxToRem(15)})}),oe=C.forwardRef(function(n,e){const s=C.useContext(ye),{value:i}=s,o=J(s,Ue),r=C.useContext(we),a=Re(A({},o,{selected:Ge(n.value,i)}),n),h=fe({props:a,name:"MuiToggleButton"}),{children:d,className:l,color:x="standard",disabled:f=!1,disableFocusRipple:m=!1,fullWidth:g=!1,onChange:v,onClick:w,selected:k,size:u="medium",value:B}=h,P=J(h,Qe),_=A({},h,{color:x,disabled:f,disableFocusRipple:m,fullWidth:g,size:u}),z=Ke(_),I=y=>{w&&(w(y,B),y.defaultPrevented)||v&&v(y,B)},p=r||"";return c.jsx(Xe,A({className:pe(o.className,z.root,l,p),disabled:f,focusRipple:!m,ref:e,onClick:I,onChange:v,value:B,ownerState:_,"aria-pressed":k},P,{children:d}))});function Ye(t){return ge("MuiToggleButtonGroup",t)}const S=he("MuiToggleButtonGroup",["root","selected","horizontal","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth","firstButton","lastButton","middleButton"]),Je=["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"],Ze=t=>{const{classes:n,orientation:e,fullWidth:s,disabled:i}=t,o={root:["root",e==="vertical"&&"vertical",s&&"fullWidth"],grouped:["grouped",`grouped${G(e)}`,i&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return xe(o,Ye,n)},et=me("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(t,n)=>{const{ownerState:e}=t;return[{[`& .${S.grouped}`]:n.grouped},{[`& .${S.grouped}`]:n[`grouped${G(e.orientation)}`]},{[`& .${S.firstButton}`]:n.firstButton},{[`& .${S.lastButton}`]:n.lastButton},{[`& .${S.middleButton}`]:n.middleButton},n.root,e.orientation==="vertical"&&n.vertical,e.fullWidth&&n.fullWidth]}})(({ownerState:t,theme:n})=>A({display:"inline-flex",borderRadius:(n.vars||n).shape.borderRadius},t.orientation==="vertical"&&{flexDirection:"column"},t.fullWidth&&{width:"100%"},{[`& .${S.grouped}`]:A({},t.orientation==="horizontal"?{[`&.${S.selected} + .${S.grouped}.${S.selected}`]:{borderLeft:0,marginLeft:0}}:{[`&.${S.selected} + .${S.grouped}.${S.selected}`]:{borderTop:0,marginTop:0}})},t.orientation==="horizontal"?{[`& .${S.firstButton},& .${S.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${S.lastButton},& .${S.middleButton}`]:{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0}}:{[`& .${S.firstButton},& .${S.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${S.lastButton},& .${S.middleButton}`]:{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0}},t.orientation==="horizontal"?{[`& .${S.lastButton}.${N.disabled},& .${S.middleButton}.${N.disabled}`]:{borderLeft:"1px solid transparent"}}:{[`& .${S.lastButton}.${N.disabled},& .${S.middleButton}.${N.disabled}`]:{borderTop:"1px solid transparent"}})),tt=C.forwardRef(function(n,e){const s=fe({props:n,name:"MuiToggleButtonGroup"}),{children:i,className:o,color:r="standard",disabled:a=!1,exclusive:h=!1,fullWidth:d=!1,onChange:l,orientation:x="horizontal",size:f="medium",value:m}=s,g=J(s,Je),v=A({},s,{disabled:a,fullWidth:d,orientation:x,size:f}),w=Ze(v),k=C.useCallback((I,p)=>{if(!l)return;const y=m&&m.indexOf(p);let M;m&&y>=0?(M=m.slice(),M.splice(y,1)):M=m?m.concat(p):[p],l(I,M)},[l,m]),u=C.useCallback((I,p)=>{l&&l(I,m===p?null:p)},[l,m]),B=C.useMemo(()=>({className:w.grouped,onChange:h?u:k,value:m,size:f,fullWidth:d,color:r,disabled:a}),[w.grouped,h,u,k,m,f,d,r,a]),P=He(i),_=P.length,z=I=>{const p=I===0,y=I===_-1;return p&&y?"":p?w.firstButton:y?w.lastButton:w.middleButton};return c.jsx(et,A({role:"group",className:pe(w.root,o),ref:e,ownerState:v},g,{children:c.jsx(ye.Provider,{value:B,children:P.map((I,p)=>c.jsx(we.Provider,{value:z(p),children:I},p))})}))});var st=class extends De{constructor(t,n){super(t,n)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(t){super.setOptions({...t,behavior:ie()})}getOptimisticResult(t){return t.behavior=ie(),super.getOptimisticResult(t)}fetchNextPage(t){return this.fetch({...t,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(t){return this.fetch({...t,meta:{fetchMore:{direction:"backward"}}})}createResult(t,n){var g,v;const{state:e}=t,s=super.createResult(t,n),{isFetching:i,isRefetching:o,isError:r,isRefetchError:a}=s,h=(v=(g=e.fetchMeta)==null?void 0:g.fetchMore)==null?void 0:v.direction,d=r&&h==="forward",l=i&&h==="forward",x=r&&h==="backward",f=i&&h==="backward";return{...s,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:Pe(n,e.data),hasPreviousPage:Be(n,e.data),isFetchNextPageError:d,isFetchingNextPage:l,isFetchPreviousPageError:x,isFetchingPreviousPage:f,isRefetchError:a&&!d&&!x,isRefetching:o&&!l&&!f}}};function it(t,n){return Ne(t,st)}const nt=U(c.jsx("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z"}),"ArrowDownward"),ot=U(c.jsx("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"}),"ArrowUpward"),rt=U(c.jsx("path",{d:"M3 14h4v-4H3zm0 5h4v-4H3zM3 9h4V5H3zm5 5h13v-4H8zm0 5h13v-4H8zM8 5v4h13V5z"}),"ViewList"),at=U(c.jsx("path",{d:"M14.67 5v6.5H9.33V5zm1 6.5H21V5h-5.33zm-1 7.5v-6.5H9.33V19zm1-6.5V19H21v-6.5zm-7.34 0H3V19h5.33zm0-1V5H3v6.5z"}),"ViewModule"),Z={async getPackages(t={}){const{searchTerm:n,selectedTags:e=[],minStars:s,hasGithub:i,hasWebserver:o,hasPublication:r,minCitations:a,minRating:h,folder:d,category:l,selectedLicenses:x=[],sortBy:f,sortDirection:m="desc",page:g=1,pageSize:v=50,includeUserRatings:w=!1,currentUserId:k}=t;let u=R.from("packages").select(`
        *,
        package_tags!left(
          tag_id,
          tags!inner(id, name)
        ),
        package_folder_categories!left(
          folder_category_id,
          folder_categories!inner(
            id,
            folder_id,
            category_id,
            folders!inner(id, name),
            categories!inner(id, name)
          )
        )
      `,{count:"exact"});if(n&&n.trim()&&(u=u.or(`package_name.ilike.%${n}%,description.ilike.%${n}%`)),e.length>0){const{data:p}=await R.from("tags").select("id, name").in("name",e);if(p&&p.length>0){const y=p.map(M=>M.id);for(const M of y){const{data:j}=await R.from("package_tags").select("package_id").eq("tag_id",M);if(j&&j.length>0){const E=j.map(W=>W.package_id);u=u.in("id",E)}else u=u.eq("id","00000000-0000-0000-0000-000000000000")}}}if(d||l){let p=R.from("folder_categories").select("id");if(d){const{data:M}=await R.from("folders").select("id").eq("name",d).single();M&&(p=p.eq("folder_id",M.id))}if(l){const{data:M}=await R.from("categories").select("id").eq("name",l).single();M&&(p=p.eq("category_id",M.id))}const{data:y}=await p;if(y&&y.length>0){const M=y.map(E=>E.id),{data:j}=await R.from("package_folder_categories").select("package_id").in("folder_category_id",M);if(j&&j.length>0){const E=j.map(W=>W.package_id);u=u.in("id",E)}else u=u.eq("id","00000000-0000-0000-0000-000000000000")}}if(s!=null&&(u=u.gte("github_stars",s)),i&&(u=u.not("repo_link","is",null)),o&&(u=u.not("webserver","is",null)),r&&(u=u.not("publication","is",null)),a!=null&&(u=u.gte("citations",a)),h!=null&&(u=u.gte("average_rating",h)),x.length>0&&(u=u.in("license",x)),f){const p=m==="asc";u=u.order(f,{ascending:p})}if(g&&v){const p=(g-1)*v,y=p+v-1;u=u.range(p,y)}const{data:B,error:P,count:_}=await u;if(P)throw P;let z;if(w&&k&&B){const p=B.map(y=>y.id);if(p.length>0){const{data:y}=await R.from("ratings").select("package_id, rating, id").eq("user_id",k).in("package_id",p);y&&(z=new Map(y.map(M=>[M.package_id,{rating:M.rating,rating_id:M.id}])))}}return{packages:(B||[]).map(re),totalCount:_||0,userRatings:z}},async getPackageById(t){const{data:n,error:e}=await R.from("packages").select(`
        *,
        package_folder_categories!left (
          folder_categories (
            folders (name),
            categories (name)
          )
        ),
        package_tags!left (
          tags (name)
        )
      `).eq("id",t).single();if(e)throw e;if(!n)throw new Error("Package not found");return re(n)},async createPackage(t){const{tags:n,folder:e,category:s,...i}=t,{data:o,error:r}=await R.from("packages").insert(i).select().single();if(r)throw r;return n&&n.length>0&&await R.rpc("update_package_tags",{package_uuid:o.id,new_tags:n}),e&&s&&await R.rpc("update_package_folder_category",{package_uuid:o.id,folder_name:e,category_name:s}),Z.getPackageById(o.id)},async updatePackage(t,n){const{tags:e,folder:s,category:i,...o}=n,{error:r}=await R.from("packages").update(o).eq("id",t);if(r)throw r;return e!==void 0&&await R.rpc("update_package_tags",{package_uuid:t,new_tags:e}),(s!==void 0||i!==void 0)&&await R.rpc("update_package_folder_category",{package_uuid:t,folder_name:s||null,category_name:i||null}),Z.getPackageById(t)},async deletePackage(t){const{error:n}=await R.from("packages").delete().eq("id",t);if(n)throw n}};function re(t){var n,e,s,i,o,r,a,h,d;return{...t,folder:((i=(s=(e=(n=t.package_folder_categories)==null?void 0:n[0])==null?void 0:e.folder_categories)==null?void 0:s.folders)==null?void 0:i.name)||"",category:((h=(a=(r=(o=t.package_folder_categories)==null?void 0:o[0])==null?void 0:r.folder_categories)==null?void 0:a.categories)==null?void 0:h.name)||"",tags:((d=t.package_tags)==null?void 0:d.map(l=>{var x;return(x=l.tags)==null?void 0:x.name}).filter(Boolean))||[]}}function lt(t={}){return it({queryKey:be.packages.infinite(t),queryFn:({pageParam:n=1})=>Z.getPackages({...t,page:n}),initialPageParam:1,getNextPageParam:(n,e)=>e.reduce((i,o)=>i+o.packages.length,0)<n.totalCount?e.length+1:void 0,staleTime:1e3*60*5,gcTime:1e3*60*30})}const ct={async getFilterMetadata(){var x,f,m,g,v,w;const[t,n,e,s,i,o]=await Promise.all([R.from("tags").select("name").order("name"),R.from("packages").select("license").not("license","is",null),R.from("folder_categories").select(`
        folders!inner(name),
        categories!inner(name)
      `).order("folders(name), categories(name)"),R.from("packages").select("github_stars").not("github_stars","is",null).order("github_stars",{ascending:!1}).limit(1),R.from("packages").select("citations").not("citations","is",null).order("citations",{ascending:!1}).limit(1),R.from("packages").select("id",{count:"exact",head:!0})]);if(t.error)throw t.error;if(n.error)throw n.error;if(e.error)throw e.error;if(s.error)throw s.error;if(i.error)throw i.error;if(o.error)throw o.error;const r=((x=t.data)==null?void 0:x.map(k=>k.name))||[],a=Array.from(new Set((f=n.data)==null?void 0:f.map(k=>k.license).filter(Boolean))).sort(),h=e.data||[],d={};h.forEach(k=>{var P,_;const u=(P=k.folders)==null?void 0:P.name,B=(_=k.categories)==null?void 0:_.name;u&&B&&(d[u]||(d[u]=[]),d[u].includes(B)||d[u].push(B))}),Object.keys(d).forEach(k=>{d[k].sort()});const l=Object.keys(d).sort();return{allAvailableTags:r,allAvailableLicenses:a,allAvailableFolders:l,allAvailableCategories:d,datasetMaxStars:((g=(m=s.data)==null?void 0:m[0])==null?void 0:g.github_stars)||0,datasetMaxCitations:((w=(v=i.data)==null?void 0:v[0])==null?void 0:w.citations)||0,totalPackageCount:o.count||0}}};function dt(){return Ve({queryKey:be.metadata.all(),queryFn:ct.getFilterMetadata,staleTime:1e3*60*30,gcTime:1e3*60*60})}function D(t,n,e){let s=e.initialDeps??[],i;function o(){var r,a,h,d;let l;e.key&&((r=e.debug)!=null&&r.call(e))&&(l=Date.now());const x=t();if(!(x.length!==s.length||x.some((g,v)=>s[v]!==g)))return i;s=x;let m;if(e.key&&((a=e.debug)!=null&&a.call(e))&&(m=Date.now()),i=n(...x),e.key&&((h=e.debug)!=null&&h.call(e))){const g=Math.round((Date.now()-l)*100)/100,v=Math.round((Date.now()-m)*100)/100,w=v/16,k=(u,B)=>{for(u=String(u);u.length<B;)u=" "+u;return u};console.info(`%c⏱ ${k(v,5)} /${k(g,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*w,120))}deg 100% 31%);`,e==null?void 0:e.key)}return(d=e==null?void 0:e.onChange)==null||d.call(e,i),i}return o.updateDeps=r=>{s=r},o}function ae(t,n){if(t===void 0)throw new Error("Unexpected undefined");return t}const ut=(t,n)=>Math.abs(t-n)<1.01,ht=(t,n,e)=>{let s;return function(...i){t.clearTimeout(s),s=t.setTimeout(()=>n.apply(this,i),e)}},le=t=>{const{offsetWidth:n,offsetHeight:e}=t;return{width:n,height:e}},gt=t=>t,ft=t=>{const n=Math.max(t.startIndex-t.overscan,0),e=Math.min(t.endIndex+t.overscan,t.count-1),s=[];for(let i=n;i<=e;i++)s.push(i);return s},mt=(t,n)=>{const e=t.scrollElement;if(!e)return;const s=t.targetWindow;if(!s)return;const i=r=>{const{width:a,height:h}=r;n({width:Math.round(a),height:Math.round(h)})};if(i(le(e)),!s.ResizeObserver)return()=>{};const o=new s.ResizeObserver(r=>{const a=()=>{const h=r[0];if(h!=null&&h.borderBoxSize){const d=h.borderBoxSize[0];if(d){i({width:d.inlineSize,height:d.blockSize});return}}i(le(e))};t.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(a):a()});return o.observe(e,{box:"border-box"}),()=>{o.unobserve(e)}},ce={passive:!0},de=typeof window>"u"?!0:"onscrollend"in window,pt=(t,n)=>{const e=t.scrollElement;if(!e)return;const s=t.targetWindow;if(!s)return;let i=0;const o=t.options.useScrollendEvent&&de?()=>{}:ht(s,()=>{n(i,!1)},t.options.isScrollingResetDelay),r=l=>()=>{const{horizontal:x,isRtl:f}=t.options;i=x?e.scrollLeft*(f&&-1||1):e.scrollTop,o(),n(i,l)},a=r(!0),h=r(!1);h(),e.addEventListener("scroll",a,ce);const d=t.options.useScrollendEvent&&de;return d&&e.addEventListener("scrollend",h,ce),()=>{e.removeEventListener("scroll",a),d&&e.removeEventListener("scrollend",h)}},xt=(t,n,e)=>{if(n!=null&&n.borderBoxSize){const s=n.borderBoxSize[0];if(s)return Math.round(s[e.options.horizontal?"inlineSize":"blockSize"])}return t[e.options.horizontal?"offsetWidth":"offsetHeight"]},vt=(t,{adjustments:n=0,behavior:e},s)=>{var i,o;const r=t+n;(o=(i=s.scrollElement)==null?void 0:i.scrollTo)==null||o.call(i,{[s.options.horizontal?"left":"top"]:r,behavior:e})};class bt{constructor(n){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let e=null;const s=()=>e||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:e=new this.targetWindow.ResizeObserver(i=>{i.forEach(o=>{const r=()=>{this._measureElement(o.target,o)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(r):r()})}));return{disconnect:()=>{var i;(i=s())==null||i.disconnect(),e=null},observe:i=>{var o;return(o=s())==null?void 0:o.observe(i,{box:"border-box"})},unobserve:i=>{var o;return(o=s())==null?void 0:o.unobserve(i)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([s,i])=>{typeof i>"u"&&delete e[s]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:gt,rangeExtractor:ft,onChange:()=>{},measureElement:xt,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...e}},this.notify=e=>{var s,i;(i=(s=this.options).onChange)==null||i.call(s,this,e)},this.maybeNotify=D(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),e=>{this.notify(e)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var e;const s=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==s){if(this.cleanup(),!s){this.maybeNotify();return}this.scrollElement=s,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((e=this.scrollElement)==null?void 0:e.window)??null,this.elementsCache.forEach(i=>{this.observer.observe(i)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,i=>{this.scrollRect=i,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(i,o)=>{this.scrollAdjustments=0,this.scrollDirection=o?this.getScrollOffset()<i?"forward":"backward":null,this.scrollOffset=i,this.isScrolling=o,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(e,s)=>{const i=new Map,o=new Map;for(let r=s-1;r>=0;r--){const a=e[r];if(i.has(a.lane))continue;const h=o.get(a.lane);if(h==null||a.end>h.end?o.set(a.lane,a):a.end<h.end&&i.set(a.lane,!0),i.size===this.options.lanes)break}return o.size===this.options.lanes?Array.from(o.values()).sort((r,a)=>r.end===a.end?r.index-a.index:r.end-a.end)[0]:void 0},this.getMeasurementOptions=D(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(e,s,i,o,r)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:s,scrollMargin:i,getItemKey:o,enabled:r}),{key:!1}),this.getMeasurements=D(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:e,paddingStart:s,scrollMargin:i,getItemKey:o,enabled:r},a)=>{if(!r)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(l=>{this.itemSizeCache.set(l.key,l.size)}));const h=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const d=this.measurementsCache.slice(0,h);for(let l=h;l<e;l++){const x=o(l),f=this.options.lanes===1?d[l-1]:this.getFurthestMeasurement(d,l),m=f?f.end+this.options.gap:s+i,g=a.get(x),v=typeof g=="number"?g:this.options.estimateSize(l),w=m+v,k=f?f.lane:l%this.options.lanes;d[l]={index:l,start:m,size:v,end:w,key:x,lane:k}}return this.measurementsCache=d,d},{key:!1,debug:()=>this.options.debug}),this.calculateRange=D(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(e,s,i,o)=>this.range=e.length>0&&s>0?yt({measurements:e,outerSize:s,scrollOffset:i,lanes:o}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=D(()=>{let e=null,s=null;const i=this.calculateRange();return i&&(e=i.startIndex,s=i.endIndex),this.maybeNotify.updateDeps([this.isScrolling,e,s]),[this.options.rangeExtractor,this.options.overscan,this.options.count,e,s]},(e,s,i,o,r)=>o===null||r===null?[]:e({startIndex:o,endIndex:r,overscan:s,count:i}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const s=this.options.indexAttribute,i=e.getAttribute(s);return i?parseInt(i,10):(console.warn(`Missing attribute name '${s}={index}' on measured element.`),-1)},this._measureElement=(e,s)=>{const i=this.indexFromElement(e),o=this.measurementsCache[i];if(!o)return;const r=o.key,a=this.elementsCache.get(r);a!==e&&(a&&this.observer.unobserve(a),this.observer.observe(e),this.elementsCache.set(r,e)),e.isConnected&&this.resizeItem(i,this.options.measureElement(e,s,this))},this.resizeItem=(e,s)=>{const i=this.measurementsCache[e];if(!i)return;const o=this.itemSizeCache.get(i.key)??i.size,r=s-o;r!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(i,r,this):i.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=r,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(i.index),this.itemSizeCache=new Map(this.itemSizeCache.set(i.key,s)),this.notify(!1))},this.measureElement=e=>{if(!e){this.elementsCache.forEach((s,i)=>{s.isConnected||(this.observer.unobserve(s),this.elementsCache.delete(i))});return}this._measureElement(e,void 0)},this.getVirtualItems=D(()=>[this.getVirtualIndexes(),this.getMeasurements()],(e,s)=>{const i=[];for(let o=0,r=e.length;o<r;o++){const a=e[o],h=s[a];i.push(h)}return i},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const s=this.getMeasurements();if(s.length!==0)return ae(s[Ce(0,s.length-1,i=>ae(s[i]).start,e)])},this.getOffsetForAlignment=(e,s,i=0)=>{const o=this.getSize(),r=this.getScrollOffset();s==="auto"&&(s=e>=r+o?"end":"start"),s==="center"?e+=(i-o)/2:s==="end"&&(e-=o);const a=this.getTotalSize()+this.options.scrollMargin-o;return Math.max(Math.min(a,e),0)},this.getOffsetForIndex=(e,s="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const i=this.measurementsCache[e];if(!i)return;const o=this.getSize(),r=this.getScrollOffset();if(s==="auto")if(i.end>=r+o-this.options.scrollPaddingEnd)s="end";else if(i.start<=r+this.options.scrollPaddingStart)s="start";else return[r,s];const a=s==="end"?i.end+this.options.scrollPaddingEnd:i.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(a,s,i.size),s]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(e,{align:s="start",behavior:i}={})=>{i==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,s),{adjustments:void 0,behavior:i})},this.scrollToIndex=(e,{align:s="auto",behavior:i}={})=>{i==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),e=Math.max(0,Math.min(e,this.options.count-1));let o=0;const r=10,a=d=>{if(!this.targetWindow)return;const l=this.getOffsetForIndex(e,d);if(!l){console.warn("Failed to get offset for index:",e);return}const[x,f]=l;this._scrollToOffset(x,{adjustments:void 0,behavior:i}),this.targetWindow.requestAnimationFrame(()=>{const m=this.getScrollOffset(),g=this.getOffsetForIndex(e,f);if(!g){console.warn("Failed to get offset for index:",e);return}ut(g[0],m)||h(f)})},h=d=>{this.targetWindow&&(o++,o<r?this.targetWindow.requestAnimationFrame(()=>a(d)):console.warn(`Failed to scroll to index ${e} after ${r} attempts.`))};a(s)},this.scrollBy=(e,{behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+e,{adjustments:void 0,behavior:s})},this.getTotalSize=()=>{var e;const s=this.getMeasurements();let i;if(s.length===0)i=this.options.paddingStart;else if(this.options.lanes===1)i=((e=s[s.length-1])==null?void 0:e.end)??0;else{const o=Array(this.options.lanes).fill(null);let r=s.length-1;for(;r>=0&&o.some(a=>a===null);){const a=s[r];o[a.lane]===null&&(o[a.lane]=a.end),r--}i=Math.max(...o.filter(a=>a!==null))}return Math.max(i-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(e,{adjustments:s,behavior:i})=>{this.options.scrollToFn(e,{behavior:i,adjustments:s},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(n)}}const Ce=(t,n,e,s)=>{for(;t<=n;){const i=(t+n)/2|0,o=e(i);if(o<s)t=i+1;else if(o>s)n=i-1;else return i}return t>0?t-1:0};function yt({measurements:t,outerSize:n,scrollOffset:e,lanes:s}){const i=t.length-1,o=h=>t[h].start;if(t.length<=s)return{startIndex:0,endIndex:i};let r=Ce(0,i,o,e),a=r;if(s===1)for(;a<i&&t[a].end<e+n;)a++;else if(s>1){const h=Array(s).fill(0);for(;a<i&&h.some(l=>l<e+n);){const l=t[a];h[l.lane]=l.end,a++}const d=Array(s).fill(e+n);for(;r>=0&&d.some(l=>l>=e);){const l=t[r];d[l.lane]=l.start,r--}r=Math.max(0,r-r%s),a=Math.min(i,a+(s-1-a%s))}return{startIndex:r,endIndex:a}}const ue=typeof document<"u"?C.useLayoutEffect:C.useEffect;function wt(t){const n=C.useReducer(()=>({}),{})[1],e={...t,onChange:(i,o)=>{var r;o?Te.flushSync(n):n(),(r=t.onChange)==null||r.call(t,i,o)}},[s]=C.useState(()=>new bt(e));return s.setOptions(e),ue(()=>s._didMount(),[]),ue(()=>s._willUpdate()),s}function Ct(t){return wt({observeElementRect:mt,observeElementOffset:pt,scrollToFn:vt,...t})}function kt({items:t,estimateSize:n=()=>250,overscan:e=5,horizontal:s=!1,getItemKey:i,paddingStart:o=0,paddingEnd:r=0,initialOffset:a=0,scrollMargin:h=0,lanes:d=1,gap:l=0}){const x=C.useRef(null),f=Ct({count:t.length,getScrollElement:()=>x.current,estimateSize:n,overscan:e,horizontal:s,paddingStart:o,paddingEnd:r,initialOffset:a,scrollMargin:h,lanes:d,gap:l,getItemKey:i||(v=>v)}),m=C.useCallback((v,w)=>{f.scrollToIndex(v,w)},[f]),g=C.useCallback(v=>{console.debug("measureItem called for index:",v)},[]);return{parentRef:x,virtualizer:f,scrollToIndex:m,measureItem:g,virtualItems:f.getVirtualItems(),totalSize:f.getTotalSize()}}function _t(t){const n=je(),e=C.useMemo(()=>({xs:1,sm:2,md:3,lg:4,xl:4,...t}),[t]),s=q(n.breakpoints.down("sm")),i=q(n.breakpoints.down("md")),o=q(n.breakpoints.down("lg")),r=q(n.breakpoints.down("xl")),a=C.useMemo(()=>s?e.xs:i?e.sm:o?e.md:r?e.lg:e.xl,[s,i,o,r,e]),h=C.useMemo(()=>{if(typeof window>"u")return 300;const l=window.innerWidth,x=32,m=(a-1)*16,g=l-x-m;return Math.floor(g/a)},[a]),d=C.useMemo(()=>({1:350,2:320,3:300,4:280})[a]||300,[a]);return{columns:a,estimateItemWidth:h,estimateItemHeight:d,isXs:s,isSm:i,isMd:o,isLg:r}}function zt({items:t,renderItem:n,height:e="100%",width:s="100%",estimateSize:i,gap:o=16,overscan:r=2,className:a,onScroll:h,getItemKey:d,EmptyComponent:l,LoadingComponent:x,isLoading:f=!1,columnConfig:m}){const{columns:g,estimateItemHeight:v}=_t(m),w=C.useMemo(()=>{const _=[];for(let z=0;z<t.length;z+=g)_.push(t.slice(z,z+g));return _},[t,g]),{parentRef:k,virtualizer:u,virtualItems:B,totalSize:P}=kt({items:w,estimateSize:i||(()=>v),overscan:r,gap:o,getItemKey:d?_=>{const z=_*g,I=t[z];return I?d(I,z):_}:void 0});return f&&x?c.jsx(x,{}):!f&&t.length===0&&l?c.jsx(l,{}):c.jsx(T,{ref:k,className:a,onScroll:h,sx:{height:e,width:s,overflow:"auto",contain:"strict"},children:c.jsx(T,{sx:{height:P,width:"100%",position:"relative"},children:B.map(_=>{const z=w[_.index];return c.jsxs(T,{"data-index":_.index,ref:u.measureElement,sx:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${_.start}px)`,display:"grid",gridTemplateColumns:`repeat(${g}, 1fr)`,gridAutoRows:"1fr",gap:`${o}px`,padding:`0 ${o}px`,minHeight:`${_.size}px`},children:[z.map((I,p)=>{const y=_.index*g+p,M=d?d(I,y):y;return c.jsx(T,{sx:{height:"100%",width:"100%",display:"flex",flexDirection:"column"},children:n(I,y,{height:"100%",width:"100%"})},M)}),z.length<g&&Array.from({length:g-z.length}).map((I,p)=>c.jsx(T,{sx:{height:"100%",width:"100%"}},`empty-${_.index}-${p}`))]},_.key)})})})}const Mt=C.lazy(()=>ve(()=>import("./PackageCard-C6xU-Svd.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),St=C.lazy(()=>ve(()=>import("./PackageList-BUGHdAoU.js"),__vite__mapDeps([9,1,2,3,4,5,6,7,10]))),Rt=()=>{var se;const{currentUser:t}=Ee(),n=(t==null?void 0:t.id)||null,{searchTerm:e,selectedTags:s,minStars:i,hasGithub:o,hasWebserver:r,hasPublication:a,minCitations:h,minRating:d,folder:l,category:x,selectedLicenses:f,sortBy:m,sortDirection:g,viewMode:v}=X(ne(b=>({searchTerm:b.searchTerm,selectedTags:b.selectedTags,minStars:b.minStars,hasGithub:b.hasGithub,hasWebserver:b.hasWebserver,hasPublication:b.hasPublication,minCitations:b.minCitations,minRating:b.minRating,folder:b.folder,category:b.category,selectedLicenses:b.selectedLicenses,sortBy:b.sortBy,sortDirection:b.sortDirection,viewMode:b.viewMode}))),{setSort:w,setViewMode:k}=X(ne(b=>({setSort:b.setSort,setViewMode:b.setViewMode}))),{data:u,isLoading:B,error:P}=dt(),_={searchTerm:e,selectedTags:s,minStars:i,hasGithub:o,hasWebserver:r,hasPublication:a,minCitations:h,minRating:d,folder:l,category:x,selectedLicenses:f,sortBy:m,sortDirection:g,includeUserRatings:!!n,currentUserId:n},{data:z,isLoading:I,error:p,fetchNextPage:y,hasNextPage:M,isFetchingNextPage:j}=lt(_);C.useEffect(()=>{u&&X.setState({allAvailableTags:u.allAvailableTags,allAvailableLicenses:u.allAvailableLicenses,allAvailableFolders:u.allAvailableFolders,allAvailableCategories:u.allAvailableCategories,datasetMaxStars:u.datasetMaxStars,datasetMaxCitations:u.datasetMaxCitations})},[u]);const E=(z==null?void 0:z.pages.flatMap(b=>b.packages))||[],W=((se=z==null?void 0:z.pages[0])==null?void 0:se.totalCount)||0,V=B||I,F=P||p,Q=B?"metadata":I?"packages":"none",ee=Oe.useCallback(b=>{const{scrollTop:$,scrollHeight:K,clientHeight:Se}=b.currentTarget;K-$-Se<200&&M&&!j&&y()},[M,j,y]),ke=b=>{const $=b.target.value;w($===""?null:$,g)},_e=()=>{w(m,g==="asc"?"desc":"asc")},ze=(b,$)=>{$!==null&&k($)},Me=(b,$,K)=>c.jsx(C.Suspense,{fallback:te,children:c.jsx(T,{style:K,children:c.jsx(Mt,{pkg:b})})},b.id),te=c.jsx(T,{display:"flex",justifyContent:"center",py:4,children:c.jsx(Y,{})});return c.jsxs($e,{maxWidth:"xl",sx:{pt:2,px:{xs:1,sm:2},pb:0},children:[F&&!V&&c.jsx(T,{py:4,children:c.jsxs(Ae,{severity:"error",sx:{mb:2},children:[c.jsx(O,{variant:"body1",fontWeight:"medium",children:(F==null?void 0:F.message)||"An error occurred"}),c.jsx(O,{variant:"body2",sx:{mt:1},children:"Please try again or refresh the page. If the problem persists, contact support."})]})}),V&&Q==="metadata"&&c.jsxs(T,{display:"flex",flexDirection:"column",alignItems:"center",py:6,gap:2,children:[c.jsx(Y,{}),c.jsx(O,{variant:"body1",color:"text.secondary",align:"center",children:"Loading filter options..."}),c.jsx(O,{variant:"body2",color:"text.secondary",align:"center",sx:{maxWidth:600},children:"Loading filter options for the best browsing experience."})]}),Q!=="metadata"&&c.jsxs(T,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,flexWrap:"wrap",gap:1},children:[c.jsx(T,{sx:{display:"flex",alignItems:"center",gap:2},children:V&&Q==="packages"?c.jsxs(T,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[c.jsx(Y,{size:24}),c.jsx(O,{variant:"h4",component:"h1",sx:{color:"text.secondary",fontWeight:500,letterSpacing:"-0.01em"},children:"Loading packages..."})]}):c.jsxs(O,{variant:"h4",component:"h1",sx:{mb:{xs:1,sm:0},color:"text.primary",fontWeight:500,letterSpacing:"-0.01em"},children:[W," Entries Found"]})}),c.jsxs(T,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[c.jsx(O,{variant:"body2",sx:{mr:1,minWidth:55,color:"text.secondary"},children:"Sort by:"}),c.jsx(We,{size:"small",variant:"outlined",sx:{minWidth:150},children:c.jsxs(Fe,{id:"sort-by-select",name:"sortBy",value:m??"",displayEmpty:!0,onChange:ke,MenuProps:{PaperProps:{sx:{mt:1,borderRadius:2,minWidth:180}}},children:[c.jsx(L,{value:"package_name",children:"Name"}),c.jsx(L,{value:"average_rating",children:"Rating"}),c.jsx(L,{value:"ratings_count",children:"Number of Ratings"}),c.jsx(L,{value:"github_stars",children:"GitHub Stars"}),c.jsx(L,{value:"citations",children:"Citations"}),c.jsx(L,{value:"last_commit",children:"Last Commit"})]})}),c.jsx(Le,{onClick:_e,size:"small","aria-label":"toggle sort direction",sx:{border:"1px solid",borderColor:"divider",ml:1,background:b=>b.palette.mode==="dark"?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.04)","&:hover":{background:b=>b.palette.action.hover}},children:g==="asc"?c.jsx(ot,{fontSize:"small"}):c.jsx(nt,{fontSize:"small"})}),c.jsxs(tt,{value:v,exclusive:!0,onChange:ze,"aria-label":"view mode",size:"small",sx:{ml:{sm:2},background:"transparent",borderRadius:2},children:[c.jsx(oe,{value:"card","aria-label":"card view",sx:{borderRadius:1,px:1.5},children:c.jsx(at,{})}),c.jsx(oe,{value:"list","aria-label":"list view",sx:{borderRadius:1,px:1.5},children:c.jsx(rt,{})})]})]})]}),!V&&!F&&c.jsx(C.Suspense,{fallback:te,children:v==="card"?c.jsx(zt,{items:E,renderItem:Me,height:"100vh",width:"100%",gap:10,overscan:2,getItemKey:b=>b.id,onScroll:ee}):c.jsx(St,{packages:E,height:"100vh",onScroll:ee})}),!V&&!F&&E.length===0&&W===0&&c.jsxs(T,{sx:{textAlign:"center",mt:4,py:4},children:[c.jsx(O,{variant:"h6",color:"text.secondary",children:"No packages found matching your criteria."}),c.jsx(O,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Try adjusting your filters or search terms."})]})]})},jt=Object.freeze(Object.defineProperty({__proto__:null,default:Rt},Symbol.toStringTag,{value:"Module"}));export{jt as H,kt as u};
