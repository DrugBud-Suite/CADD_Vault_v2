import{c as v,j as a,o as C,r as s,m as i,q as o,T as l,V as w,L as R,ap as h,at as S,U as I,ax as P,N as f,I as T,ay as z}from"./index-lkaWrI8o.js";import{R as W}from"./ratingService-GSGPWlR-.js";import{R as E}from"./RatingInput-CivWvX4T.js";import{P as _,a as O}from"./PackageMetrics-BPkTNSsf.js";import{C as A,a as u}from"./CardContent-BExDXR57.js";import"./Delete-C2QYofuS.js";const L=v(a.jsx("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreHoriz"),$=({pkg:n})=>{const b=C(r=>r.addTag),[p,c]=s.useState(null),[t,d]=s.useState(n),x=s.useRef(!0);s.useEffect(()=>{d(n)},[n]),s.useEffect(()=>W.subscribe(e=>{e.packageId===n.id&&x.current&&d(y=>({...y,average_rating:e.averageRating,ratings_count:e.ratingsCount}))}),[n.id]),s.useEffect(()=>()=>{x.current=!1},[]);const g=r=>{b(r)},j=r=>{c(r.currentTarget)},m=()=>{c(null)},k=!!p;return a.jsxs(A,{sx:{height:"100%",display:"flex",flexDirection:"column",transition:r=>r.transitions.create(["box-shadow","transform","background"],{duration:r.transitions.duration.short}),"&:hover":{boxShadow:r=>`0 0px 24px ${i(r.palette.primary.main,.3)}`,transform:"translateY(-2px)",background:r=>r.palette.mode==="dark"?"linear-gradient(135deg, rgba(30,30,30,0.95) 0%, rgba(23,23,23,0.95) 100%)":"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(249,250,251,0.95) 100%)"},background:r=>r.palette.mode==="dark"?"linear-gradient(135deg, rgba(30,30,30,0.8) 0%, rgba(23,23,23,0.8) 100%)":"linear-gradient(135deg, rgba(255,255,255,0.8) 0%, rgba(249,250,251,0.8) 100%)",backdropFilter:"blur(8px)",border:0,overflow:"hidden",borderRadius:2},children:[a.jsxs(u,{sx:{flexGrow:1,display:"flex",flexDirection:"column",p:2,pb:1.5},children:[a.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:.5},children:[a.jsx(l,{variant:"h6",component:"h2",sx:{fontWeight:600,pr:2,flexGrow:1,fontSize:"1.05rem",color:r=>r.palette.mode==="dark"?r.palette.primary.light:r.palette.primary.dark},children:a.jsx(w,{component:R,to:`/package/${encodeURIComponent(t.id)}`,underline:"none",sx:{position:"relative",transition:"all 0.2s ease-in-out",color:"text.primary","&:hover":{color:r=>(r.palette.mode==="dark",r.palette.primary.main),transform:"translateY(-1px)"},"&::after":{content:'""',position:"absolute",width:"100%",transform:"scaleX(0)",height:"1px",bottom:0,left:0,backgroundColor:"primary.main",transformOrigin:"bottom right",transition:"transform 0.25s ease-out"},"&:hover::after":{transform:"scaleX(1)",transformOrigin:"bottom left"}},children:t.package_name})}),a.jsx(o,{sx:{flexShrink:0},children:a.jsx(E,{packageId:t.id,averageRating:t.average_rating??0,ratingsCount:t.ratings_count??0,userRating:t.user_rating,userRatingId:t.user_rating_id})})]}),a.jsx(h,{title:t.description,children:a.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:1.25,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",lineHeight:1.5},children:t.description})}),a.jsx(o,{sx:{flexGrow:1}}),a.jsx(o,{sx:{pt:1},children:a.jsx(_,{pkg:t})}),a.jsx(o,{sx:{pt:1},children:a.jsx(O,{pkg:t,variant:"card"})})]}),t.tags&&t.tags.length>0&&a.jsxs(a.Fragment,{children:[a.jsx(S,{sx:{mx:0}}),a.jsxs(u,{sx:{pt:1.25,pb:"12px !important",px:2,height:"76px",position:"relative",overflow:"hidden"},children:[a.jsxs(I,{direction:"row",alignItems:"flex-start",spacing:1,children:[a.jsx(o,{sx:{display:"flex",alignItems:"center",flexShrink:0,color:"text.secondary",mt:.5},children:a.jsx(P,{size:14})}),a.jsx(o,{sx:{display:"flex",flexWrap:"wrap",gap:.75,alignItems:"flex-start",minWidth:0,maxWidth:"calc(100% - 50px)",maxHeight:"62px",overflow:"hidden",pr:1},children:t.tags.map(r=>a.jsx(f,{label:r,size:"small",sx:{height:"22px",borderRadius:4,bgcolor:e=>e.palette.mode==="dark"?i(e.palette.primary.main,.15):i(e.palette.primary.light,.15),color:"primary.main",fontWeight:500,fontSize:"0.7rem",mb:.35,"&:hover":{bgcolor:e=>e.palette.mode==="dark"?i(e.palette.primary.main,.25):i(e.palette.primary.light,.25)},cursor:"pointer"},onClick:()=>g(r)},r))}),a.jsx(o,{sx:{position:"absolute",right:8,top:10},children:a.jsx(h,{title:"See All Tags",arrow:!0,children:a.jsx(T,{size:"small",onClick:j,sx:{width:28,height:28,bgcolor:r=>i(r.palette.primary.main,.1),color:"primary.main","&:hover":{bgcolor:r=>i(r.palette.primary.main,.2)}},children:a.jsx(L,{fontSize:"small"})})})})]}),a.jsxs(z,{open:k,anchorEl:p,onClose:m,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{p:2,maxWidth:320,boxShadow:3}},children:[a.jsx(l,{variant:"subtitle2",sx:{mb:1.5,fontWeight:600},children:"All Tags"}),a.jsx(o,{sx:{display:"flex",flexWrap:"wrap",gap:.75},children:t.tags.map(r=>a.jsx(f,{label:r,size:"small",sx:{height:"24px",borderRadius:4,bgcolor:e=>e.palette.mode==="dark"?i(e.palette.primary.main,.15):i(e.palette.primary.light,.15),color:"primary.main",fontWeight:500,fontSize:"0.7rem",mb:.5,"&:hover":{bgcolor:e=>e.palette.mode==="dark"?i(e.palette.primary.main,.25):i(e.palette.primary.light,.25)},cursor:"pointer"},onClick:()=>{g(r),m()}},r))})]})]})]})]})};export{$ as default};
