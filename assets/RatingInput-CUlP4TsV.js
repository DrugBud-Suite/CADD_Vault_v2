import{c as B,j as n,a as Ie,g as Pe,r as x,d as _e,_ as he,aC as me,u as we,e as Be,aD as Oe,ab as Te,b as m,s as J,f as G,h as fe,i as $e,aE as De,aF as Ne,aG as qe,x as ve,y as ge,z as xe,D as ye,n as ke,a5 as ae,q as se,ap as Ue,I as We,t as re,T as Y,ay as Xe,U as Ye,A as Ge,H as Je}from"./index-CD-axZbQ.js";import{D as Ke}from"./Delete-B0txHjin.js";import{a as le,R as ce}from"./ratingService-Clu1QVa-.js";const Qe=B(n.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Star"),Ze=B(n.jsx("path",{d:"M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"}),"StarBorder");function et(e){return Pe("MuiRating",e)}const N=Ie("MuiRating",["root","sizeSmall","sizeMedium","sizeLarge","readOnly","disabled","focusVisible","visuallyHidden","pristine","label","labelEmptyValueActive","icon","iconEmpty","iconFilled","iconHover","iconFocus","iconActive","decimal"]),tt=["value"],nt=["className","defaultValue","disabled","emptyIcon","emptyLabelText","getLabelText","highlightSelectedOnly","icon","IconContainerComponent","max","name","onChange","onChangeActive","onMouseLeave","onMouseMove","precision","readOnly","size","value"];function ot(e){const t=e.toString().split(".")[1];return t?t.length:0}function ee(e,t){if(e==null)return e;const o=Math.round(e/t)*t;return Number(o.toFixed(ot(t)))}const it=e=>{const{classes:t,size:o,readOnly:a,disabled:v,emptyValueFocused:C,focusVisible:u}=e,b={root:["root",`size${fe(o)}`,v&&"disabled",u&&"focusVisible",a&&"readOnly"],label:["label","pristine"],labelEmptyValue:[C&&"labelEmptyValueActive"],icon:["icon"],iconEmpty:["iconEmpty"],iconFilled:["iconFilled"],iconHover:["iconHover"],iconFocus:["iconFocus"],iconActive:["iconActive"],decimal:["decimal"],visuallyHidden:["visuallyHidden"]};return $e(b,et,t)},at=J("span",{name:"MuiRating",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[{[`& .${N.visuallyHidden}`]:t.visuallyHidden},t.root,t[`size${fe(o.size)}`],o.readOnly&&t.readOnly]}})(({theme:e,ownerState:t})=>m({display:"inline-flex",position:"relative",fontSize:e.typography.pxToRem(24),color:"#faaf00",cursor:"pointer",textAlign:"left",width:"min-content",WebkitTapHighlightColor:"transparent",[`&.${N.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${N.focusVisible} .${N.iconActive}`]:{outline:"1px solid #999"},[`& .${N.visuallyHidden}`]:De},t.size==="small"&&{fontSize:e.typography.pxToRem(18)},t.size==="large"&&{fontSize:e.typography.pxToRem(30)},t.readOnly&&{pointerEvents:"none"})),be=J("label",{name:"MuiRating",slot:"Label",overridesResolver:({ownerState:e},t)=>[t.label,e.emptyValueFocused&&t.labelEmptyValueActive]})(({ownerState:e})=>m({cursor:"inherit"},e.emptyValueFocused&&{top:0,bottom:0,position:"absolute",outline:"1px solid #999",width:"100%"})),st=J("span",{name:"MuiRating",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.icon,o.iconEmpty&&t.iconEmpty,o.iconFilled&&t.iconFilled,o.iconHover&&t.iconHover,o.iconFocus&&t.iconFocus,o.iconActive&&t.iconActive]}})(({theme:e,ownerState:t})=>m({display:"flex",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest}),pointerEvents:"none"},t.iconActive&&{transform:"scale(1.2)"},t.iconEmpty&&{color:(e.vars||e).palette.action.disabled})),rt=J("span",{name:"MuiRating",slot:"Decimal",shouldForwardProp:e=>Ne(e)&&e!=="iconActive",overridesResolver:(e,t)=>{const{iconActive:o}=e;return[t.decimal,o&&t.iconActive]}})(({iconActive:e})=>m({position:"relative"},e&&{transform:"scale(1.2)"}));function lt(e){const t=he(e,tt);return n.jsx("span",m({},t))}function ue(e){const{classes:t,disabled:o,emptyIcon:a,focus:v,getLabelText:C,highlightSelectedOnly:u,hover:b,icon:M,IconContainerComponent:p,isActive:R,itemValue:d,labelProps:f,name:c,onBlur:O,onChange:y,onClick:F,onFocus:H,readOnly:L,ownerState:r,ratingValue:s,ratingValueRounded:V}=e,h=u?d===s:d<=s,U=d<=b,I=d<=v,K=d===V,T=me(),A=n.jsx(st,{as:p,value:d,className:G(t.icon,h?t.iconFilled:t.iconEmpty,U&&t.iconHover,I&&t.iconFocus,R&&t.iconActive),ownerState:m({},r,{iconEmpty:!h,iconFilled:h,iconHover:U,iconFocus:I,iconActive:R}),children:a&&!h?a:M});return L?n.jsx("span",m({},f,{children:A})):n.jsxs(x.Fragment,{children:[n.jsxs(be,m({ownerState:m({},r,{emptyValueFocused:void 0}),htmlFor:T},f,{children:[A,n.jsx("span",{className:t.visuallyHidden,children:C(d)})]})),n.jsx("input",{className:t.visuallyHidden,onFocus:H,onBlur:O,onChange:y,onClick:F,disabled:o,value:d,id:T,type:"radio",name:c,checked:K})]})}const ct=n.jsx(Qe,{fontSize:"inherit"}),ut=n.jsx(Ze,{fontSize:"inherit"});function dt(e){return`${e} Star${e!==1?"s":""}`}const pt=x.forwardRef(function(t,o){const a=_e({name:"MuiRating",props:t}),{className:v,defaultValue:C=null,disabled:u=!1,emptyIcon:b=ut,emptyLabelText:M="Empty",getLabelText:p=dt,highlightSelectedOnly:R=!1,icon:d=ct,IconContainerComponent:f=lt,max:c=5,name:O,onChange:y,onChangeActive:F,onMouseLeave:H,onMouseMove:L,precision:r=1,readOnly:s=!1,size:V="medium",value:h}=a,U=he(a,nt),I=me(O),[K,T]=we({controlled:h,default:C,name:"Rating"}),A=ee(K,r),Re=Be(),[{hover:S,focus:W},$]=x.useState({hover:-1,focus:-1});let P=A;S!==-1&&(P=S),W!==-1&&(P=W);const{isFocusVisibleRef:te,onBlur:Se,onFocus:je,ref:Ce}=Oe(),[Fe,Q]=x.useState(!1),ne=x.useRef(),ze=Te(Ce,ne,o),Me=i=>{L&&L(i);const l=ne.current,{right:g,left:X,width:_}=l.getBoundingClientRect();let w;Re?w=(g-i.clientX)/_:w=(i.clientX-X)/_;let j=ee(c*w+r/2,r);j=qe(j,r,c),$(E=>E.hover===j&&E.focus===j?E:{hover:j,focus:j}),Q(!1),F&&S!==j&&F(i,j)},Le=i=>{H&&H(i);const l=-1;$({hover:l,focus:l}),F&&S!==l&&F(i,l)},oe=i=>{let l=i.target.value===""?null:parseFloat(i.target.value);S!==-1&&(l=S),T(l),y&&y(i,l)},Ve=i=>{i.clientX===0&&i.clientY===0||($({hover:-1,focus:-1}),T(null),y&&parseFloat(i.target.value)===A&&y(i,null))},Ae=i=>{je(i),te.current===!0&&Q(!0);const l=parseFloat(i.target.value);$(g=>({hover:g.hover,focus:l}))},Ee=i=>{if(S!==-1)return;Se(i),te.current===!1&&Q(!1);const l=-1;$(g=>({hover:g.hover,focus:l}))},[He,ie]=x.useState(!1),D=m({},a,{defaultValue:C,disabled:u,emptyIcon:b,emptyLabelText:M,emptyValueFocused:He,focusVisible:Fe,getLabelText:p,icon:d,IconContainerComponent:f,max:c,precision:r,readOnly:s,size:V}),z=it(D);return n.jsxs(at,m({ref:ze,onMouseMove:Me,onMouseLeave:Le,className:G(z.root,v,s&&"MuiRating-readOnly"),ownerState:D,role:s?"img":null,"aria-label":s?p(P):null},U,{children:[Array.from(new Array(c)).map((i,l)=>{const g=l+1,X={classes:z,disabled:u,emptyIcon:b,focus:W,getLabelText:p,highlightSelectedOnly:R,hover:S,icon:d,IconContainerComponent:f,name:I,onBlur:Ee,onChange:oe,onClick:Ve,onFocus:Ae,ratingValue:P,ratingValueRounded:A,readOnly:s,ownerState:D},_=g===Math.ceil(P)&&(S!==-1||W!==-1);if(r<1){const w=Array.from(new Array(1/r));return n.jsx(rt,{className:G(z.decimal,_&&z.iconActive),ownerState:D,iconActive:_,children:w.map((j,E)=>{const Z=ee(g-1+(E+1)*r,r);return n.jsx(ue,m({},X,{isActive:!1,itemValue:Z,labelProps:{style:w.length-1===E?{}:{width:Z===P?`${(E+1)*r*100}%`:"0%",overflow:"hidden",position:"absolute"}}}),Z)})},g)}return n.jsx(ue,m({},X,{isActive:_,itemValue:g}),g)}),!s&&!u&&n.jsxs(be,{className:G(z.label,z.labelEmptyValue),ownerState:D,children:[n.jsx("input",{className:z.visuallyHidden,value:"",id:`${I}-empty`,type:"radio",name:I,checked:A==null,onFocus:()=>ie(!0),onBlur:()=>ie(!1),onChange:oe}),n.jsx("span",{className:z.visuallyHidden,children:M})]})]}))}),St=B(n.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-5 14H7v-2h7zm3-4H7v-2h10zm0-4H7V7h10z"}),"Article"),jt=B(n.jsx("path",{d:"M9.4 16.6 4.8 12l4.6-4.6L8 6l-6 6 6 6zm5.2 0 4.6-4.6-4.6-4.6L16 6l6 6-6 6z"}),"Code"),Ct=B(n.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2m6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56M12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96M4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56m2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8M12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96M14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2m.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56M16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2z"}),"Language"),Ft=B(n.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5"}),"Link");var q={},de;function ht(){if(de)return q;de=1;var e=ve();Object.defineProperty(q,"__esModule",{value:!0}),q.default=void 0;var t=e(ge()),o=xe();return q.default=(0,t.default)((0,o.jsx)("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Star"),q}var mt=ht();const ft=ye(mt);var k={},pe;function vt(){if(pe)return k;pe=1;var e=ve();Object.defineProperty(k,"__esModule",{value:!0}),k.default=void 0;var t=e(ge()),o=xe();return k.default=(0,t.default)((0,o.jsx)("path",{d:"m22 9.24-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28z"}),"StarBorder"),k}var gt=vt();const xt=ye(gt),zt=({packageId:e,averageRating:t=0,ratingsCount:o=0,userRating:a=null})=>{const{currentUser:v}=ke(),[C,u]=x.useState(a),[b,M]=x.useState(null),[p,R]=x.useState(!1),[d,f]=x.useState(null),c=x.useRef(!0);ae.useEffect(()=>()=>{c.current=!1},[]),ae.useEffect(()=>{u(a)},[a]);const O=s=>{v&&(M(s.currentTarget),f(null))},y=()=>{M(null),u(a),f(null)},F=async(s,V)=>{if(!(!v||V===null||p)){R(!0),f(null),u(V);try{const h=await le.upsertRating(e,V);c.current&&(u(h.user_rating),ce.emit({packageId:e,averageRating:h.average_rating,ratingsCount:h.ratings_count,userRating:h.user_rating}),setTimeout(()=>{c.current&&y()},500))}catch(h){console.error("Error submitting rating:",h),c.current&&(f("Failed to submit rating. Please try again."),u(a))}finally{c.current&&R(!1)}}},H=async()=>{if(!(!v||!a||p)){R(!0),f(null);try{const s=await le.deleteRating(e);c.current&&(u(null),ce.emit({packageId:e,averageRating:s.average_rating,ratingsCount:s.ratings_count,userRating:void 0}),y())}catch(s){console.error("Error deleting rating:",s),c.current&&f("Failed to delete rating. Please try again.")}finally{c.current&&R(!1)}}},L=!!b,r=L?`rating-popover-${e}`:void 0;return n.jsxs(se,{sx:{display:"flex",alignItems:"center",gap:.5},children:[n.jsx(Ue,{title:v?"Rate this package":"Login to rate",children:n.jsx("span",{children:n.jsx(We,{size:"small",onClick:O,"aria-describedby":r,disabled:p||!v,sx:{p:.5},children:p?n.jsx(re,{size:20}):n.jsx(ft,{fontSize:"inherit",sx:{color:t>0?"warning.main":"action.disabled"}})})})}),n.jsx(Y,{variant:"body2",sx:{fontWeight:"medium",minWidth:"2ch"},children:t.toFixed(1)}),n.jsxs(Y,{variant:"body2",color:"text.secondary",sx:{minWidth:"3ch"},children:["(",o,")"]}),n.jsx(Xe,{id:r,open:L,anchorEl:b,onClose:y,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},PaperProps:{sx:{p:2,minWidth:200}},children:n.jsxs(Ye,{spacing:2,alignItems:"center",children:[n.jsx(Y,{variant:"subtitle2",color:"text.primary",children:a?"Update Your Rating":"Rate This Package"}),d&&n.jsx(Ge,{severity:"error",sx:{width:"100%",py:.5},children:d}),n.jsx(pt,{name:`rating-${e}`,value:C,onChange:F,precision:1,emptyIcon:n.jsx(xt,{fontSize:"inherit"}),disabled:p,sx:{fontSize:"1.5rem"}}),a&&n.jsx(Je,{variant:"outlined",color:"error",size:"small",startIcon:n.jsx(Ke,{}),onClick:H,disabled:p,sx:{mt:1},children:"Remove Rating"}),p&&n.jsxs(se,{sx:{display:"flex",alignItems:"center",gap:1},children:[n.jsx(re,{size:16}),n.jsx(Y,{variant:"caption",color:"text.secondary",children:a?"Updating...":"Submitting..."})]})]})})]})};export{St as A,jt as C,Ct as L,zt as R,Ft as a};
